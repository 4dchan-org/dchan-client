(this["webpackJsonpdchan-react"]=this["webpackJsonpdchan-react"]||[]).push([[0],{412:function(e){e.exports=JSON.parse('[{"anonymous":false,"inputs":[{"indexed":false,"internalType":"address","name":"from","type":"address"},{"indexed":false,"internalType":"string","name":"jsonMessage","type":"string"}],"name":"Message","type":"event"},{"inputs":[{"internalType":"string","name":"jsonMessage","type":"string"}],"name":"message","outputs":[],"stateMutability":"nonpayable","type":"function"}]')},434:function(e,t,n){},435:function(e,t,n){},450:function(e,t){},472:function(e,t){},474:function(e,t){},493:function(e,t){},497:function(e,t){},530:function(e,t){},532:function(e,t){},647:function(e,t){},649:function(e,t){},656:function(e,t){},657:function(e,t){},680:function(e,t){},712:function(e,t){},881:function(e,t,n){"use strict";n.r(t);var c=n(2),a=n.n(c),r=n(150),s=n.n(r),i=(n(434),n(8)),o=n(12),l=n(19),d=n(43),b=n(900),j=n(902),u=n(899),h=n(44),p=(n(435),n(1)),m=n.n(p),x=n(7),O=n.p+"static/media/polygon.1140771b.png",f=n.p+"static/media/thegraph.101ddbcb.png",v=n(904),g=n(28);function A(e){return g.DateTime.fromSeconds(parseInt(e))}var k,w,y=n(16),N=n(903),C=Object(N.a)(k||(k=Object(y.a)(["\n  fragment Client on Client {\n    id\n    ipfsHash\n    version\n    publishedAtBlock {\n      timestamp\n      number\n    }\n  }\n"]))),B=Object(N.a)(w||(w=Object(y.a)(["\n  ",'\n\n  query IPFSClient {\n    dev: clients(first: 1, orderBy: publishedAt, orderDirection: desc, where: {channel: ""}) {\n      ...Client\n    }\n    stable: clients(first: 1, orderBy: publishedAt, orderDirection: desc, where: {channel: "stable"}) {\n      ...Client\n    }\n  }  \n'])),C),I=n(0);function S(){var e,t,n=Object(v.a)(B,{}).data,c=null===n||void 0===n||null===(e=n.stable)||void 0===e?void 0:e[0],a=null===n||void 0===n||null===(t=n.dev)||void 0===t?void 0:t[0];return Object(I.jsx)("div",{children:Object(I.jsxs)("details",{className:"text-xs text-gray-400 hover:text-gray-600",children:[Object(I.jsx)("summary",{className:"pb-1",children:"IPFS clients"}),c?Object(I.jsxs)("div",{children:[Object(I.jsx)("span",{children:"Latest stable version, published @ ".concat(A(c.publishedAtBlock.timestamp).toLocaleString(g.DateTime.DATETIME_SHORT))}),Object(I.jsx)("a",{className:"dchan-link border border-black px-2 mx-1 bg-white",href:"//ipfs.io/ipfs/".concat(c.ipfsHash),target:"_blank",rel:"noreferrer",children:c.version}),Object(I.jsx)("hr",{})]}):Object(I.jsx)("span",{}),a?Object(I.jsxs)("div",{children:[Object(I.jsx)("span",{children:"Latest dev version, published @ ".concat(A(a.publishedAtBlock.timestamp).toLocaleString(g.DateTime.DATETIME_SHORT))}),Object(I.jsx)("a",{className:"dchan-link border border-black px-2 mx-1 bg-white",href:"//ipfs.io/ipfs/".concat(a.ipfsHash),target:"_blank",rel:"noreferrer",children:a.version}),Object(I.jsx)("hr",{})]}):Object(I.jsx)("span",{})]})})}function E(e){var t=e.className,n=void 0===t?"grid":t,c=e.bodyClassName,a=void 0===c?"":c,r=e.title,s=e.children;return Object(I.jsxs)("article",{className:"".concat(n," max-w-100vw"),children:[Object(I.jsx)("header",{className:"bg-highlight py-1 bg-white border border-black",children:Object(I.jsx)("div",{className:"text-xl text-center font-semibold",children:r})}),Object(I.jsx)("section",{className:"".concat(a," bg-white border border-black border-t-0 w-full p-1"),style:{flex:"1 1 auto"},children:s})]})}function T(){return Object(I.jsxs)("ul",{children:[Object(I.jsx)("li",{children:Object(I.jsx)("a",{href:"https://matic.supply/",target:"_blank",rel:"noreferrer",className:"dchan-link px-2",children:"https://matic.supply"})}),Object(I.jsx)("li",{children:Object(I.jsx)("a",{href:"https://macncheese.finance/matic-polygon-mainnet-faucet.php",target:"_blank",rel:"noreferrer",className:"dchan-link px-2",children:"https://macncheese.finance"})})]})}function D(e){return function(t){var n=t.onExit,c=t.overlayClassName;return Object(I.jsx)("div",{className:"flex fixed top-0 bottom-0 left-0 right-0 bg-black bg-opacity-50 cursor-default",style:{zIndex:9e3},onClick:n,children:Object(I.jsx)("div",{className:"".concat(c," m-auto"),onClick:function(e){return e.stopPropagation()},children:Object(I.jsx)(e,Object(o.a)({},t))})})}}function _(){return Object(I.jsxs)("span",{children:[Object(I.jsx)("a",{className:"text-blue-600 visited:text-purple-600",href:"//thegraph.com/",target:"_blank",rel:"noreferrer",children:"The Graph"})," ",Object(I.jsxs)("span",{className:"text-xs",children:["(ticker:"," ",Object(I.jsx)("a",{className:"text-blue-600 visited:text-purple-600",href:"//www.coingecko.com/en/coins/the-graph",target:"_blank",rel:"noreferrer",children:"GRT"}),")"]})]})}function P(){return Object(I.jsx)("a",{className:"text-blue-600 visited:text-purple-600",href:"//polygon.network/",target:"_blank",rel:"noreferrer",children:"Polygon"})}var H=D((function(e){var t=e.onExit,n=e.className;return Object(I.jsx)(E,{title:Object(I.jsx)("span",{children:"FAQ"}),className:n,bodyClassName:"flex overflow-y-auto overscroll-contain",children:Object(I.jsxs)("div",{className:"text-left p-8 text-sm",children:[Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: What is this?"}),Object(I.jsx)("div",{children:"This is dchan.network, a decentralized time-traveling imageboard."})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: ...Decentralized?"}),Object(I.jsxs)("div",{children:["dchan.network is a Web3 imageboard whose posts and images are respectively stored on ",Object(I.jsx)(P,{}),"'s blockchain and on IPFS, using"," ",Object(I.jsx)(_,{})," to index and serve the content in a decentralized manner."]})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: ...Time-Traveling?"}),Object(I.jsxs)("div",{children:["dchan.network's backend was built using ",Object(I.jsx)(_,{}),", which is capable of obtaining data as it was at any point in time, allowing you to read dchan.network's boards and threads exactly as they were, whenever in the past. This also means that there is no need for an archive, as it is already built in the protocol."]})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: ...Imageboard?"}),Object(I.jsx)("div",{children:"dchan.network is a simple image-based bulletin board where anyone can post comments, share images and create boards. It is heavily inspired by 4chan."})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: Are posts anonymous?"}),Object(I.jsxs)("div",{children:["No. Or rather, they are as anonymous as the address they're posted from.",Object(I.jsx)("br",{}),"Due to the public nature of the blockchain, posts are directly tied to whoever signed the post, meaning that ",Object(I.jsx)("b",{children:"your post history is public, tied to your wallet address' identity and to any past activity"}),".",Object(I.jsx)("br",{}),"Please be mindful of that when posting."]})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: Oh crap oh no I posted something I shouldn't have, how can I delete it?"}),Object(I.jsxs)("div",{children:["Too bad.",Object(I.jsx)("br",{}),"Once you post on the blockchain, it's forever.",Object(I.jsx)("br",{}),"You cannot delete it.",Object(I.jsx)("br",{}),"You cannot change it.",Object(I.jsx)("br",{}),Object(I.jsx)("b",{children:"The blockchain never forgets."}),Object(I.jsx)("br",{}),"Please be mindful of that when posting."]})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: Is it free?"}),Object(I.jsxs)("div",{children:["Kind of. You will need a crypto wallet to post and some ",Object(I.jsx)(P,{})," to pay the TX fee to post. A tiny bit of it should let you post a couple times, as ",Object(I.jsx)(P,{}),"'s gas fee should be cheap enough as long as the network works as intended.",Object(I.jsx)("br",{}),"You can get some free ",Object(I.jsx)(P,{})," at the following faucets:",Object(I.jsx)("div",{children:Object(I.jsx)(T,{})})]})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: How do I post?"}),Object(I.jsxs)("div",{children:["You'll need to install"," ",Object(I.jsx)("a",{className:"dchan-link",href:"//metamask.io",children:"Metamask"})," ","(if you're on Desktop) or"," ",Object(I.jsx)("a",{className:"dchan-link",href:"//trustwallet.com/",children:"Trust Wallet"})," ","(if you're on Mobile). Other wallets might not be supported. You'll need to connect your crypto wallet to post on dchan.network, but it's not required if you just want to lurk."]})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: Does dchan.network have a token? I need a useless shitcoin to lose all my life savings on."}),Object(I.jsxs)("div",{children:["dchan.network does not require any token to function except ",Object(I.jsx)(P,{})," for sending txs, so no.",Object(I.jsx)("br",{}),"This may change in the future."]})]}),Object(I.jsxs)("div",{className:"pb-2",children:[Object(I.jsx)("strong",{children:"Q: Is this open source?"}),Object(I.jsxs)("div",{children:["Of course.",Object(I.jsx)("br",{}),Object(I.jsx)("a",{className:"text-blue-600 visited:text-purple-600",href:"//github.com/dchan-network/",target:"_blank",rel:"noreferrer",children:"GitHub"})]})]}),Object(I.jsx)("div",{className:"mt-4 mb-12 text-center mx-auto cursor-pointer text-blue-600 visited:text-purple-600",onClick:t,children:"Close"})]})})})),L=Object(h.b)([!1,function(){}],(function(){return Object(c.useState)(!1)}));function M(){var e=L(),t=Object(i.a)(e,2),n=t[0],c=t[1];return n?Object(I.jsx)(H,{onExit:function(){return c(!1)},className:"h-full flex flex-col flex-grow flex-shrink-0",overlayClassName:"w-full sm:w-4/6 h-5/6"}):null}function Q(e){var t=e.className,n=void 0===t?"":t,c=L(),a=Object(i.a)(c,2)[1];return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)("span",{className:"".concat(n," cursor-pointer dchan-link"),onClick:function(e){e.stopPropagation(),e.preventDefault(),a(!0)},children:"FAQ"})})}var R=D((function(){return Object(I.jsx)(E,{title:Object(I.jsx)("span",{children:"The rules"}),className:"flex flex-col flex-grow flex-shrink-0",bodyClassName:"flex",children:Object(I.jsx)("div",{className:"p-8",children:Object(I.jsxs)("ul",{className:"list-disc text-wrap text-left m-auto",children:[Object(I.jsx)("li",{children:"Do not post anything that can get you in trouble with local or global jurisdictions."}),Object(I.jsx)("li",{children:"Be decent."})]})})})})),F=Object(h.b)([!1,function(){}],(function(){return Object(c.useState)(!1)}));function z(){var e=F(),t=Object(i.a)(e,2),n=t[0],c=t[1];return n?Object(I.jsx)(R,{onExit:function(){return c(!1)}}):null}function q(e){var t=e.className,n=void 0===t?"":t,c=F(),a=Object(i.a)(c,2)[1];return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)("span",{className:"".concat(n," cursor-pointer dchan-link"),onClick:function(e){e.stopPropagation(),e.preventDefault(),a(!0)},children:"Rules"})})}var W=D((function(){return Object(I.jsx)(E,{title:Object(I.jsx)("div",{className:"",children:"Abuse (DMCA/CSAM)"}),children:Object(I.jsxs)("div",{className:"text-left p-4",children:["This is a decentralized application: the content shown here is not hosted on this website's servers, but is instead retrieved via ",Object(I.jsx)("a",{className:"dchan-link",href:"https://ipfs.io/",rel:"nofollow",children:"IPFS"}),".",Object(I.jsx)("br",{}),"Please refer to the IPFS Gateway Service's ",Object(I.jsx)("a",{className:"dchan-link",href:"https://ipfs.io/legal/",rel:"nofollow",children:"legal page"})," to report any offending content."]})})})),U=Object(h.b)([!1,function(){}],(function(){return Object(c.useState)(!1)}));function Y(){var e=U(),t=Object(i.a)(e,2),n=t[0],c=t[1];return n?Object(I.jsx)(W,{onExit:function(){return c(!1)}}):null}function V(e){var t=e.className,n=void 0===t?"":t,c=U(),a=Object(i.a)(c,2)[1];return Object(I.jsx)(I.Fragment,{children:Object(I.jsx)("span",{className:"".concat(n," cursor-pointer dchan-link"),onClick:function(e){e.stopPropagation(),e.preventDefault(),a(!0)},children:"Abuse (DMCA/CSAM)"})})}function J(e){var t=e.showContentDisclaimer,n=void 0!==t&&t,c=e.className,a=void 0===c?"mt-auto":c;return Object(I.jsxs)("div",{className:"bg-primary ".concat(a),children:[Object(I.jsx)("div",{id:"bottom"}),Object(I.jsxs)("footer",{className:"mt-4",children:[n?Object(I.jsx)("div",{className:"text-xs text-gray-400 hover:text-gray-600",children:"All trademarks and copyrights on this page are owned by their respective parties. Posted content is responsibility of the poster."}):"",Object(I.jsxs)("div",{className:"grid items-start grid-cols-3 mt-1 border-t border-black text-xs relative w-100vw overflow-visible",children:[Object(I.jsxs)("div",{className:"text-left px-6",children:[Object(I.jsx)("div",{children:"Powered by"}),Object(I.jsxs)("div",{className:"flex m-1",children:[Object(I.jsx)("a",{className:"mx-1",href:"//polygon.technology/",target:"_blank",rel:"noreferrer",children:Object(I.jsx)("img",{className:"w-4 h-4",src:O,alt:"Polygon"})}),Object(I.jsx)("a",{className:"mx-1",href:"//thegraph.com/",target:"_blank",rel:"noreferrer",children:Object(I.jsx)("img",{className:"w-4 h-4",src:f,alt:"The Graph"})})]})]}),Object(I.jsxs)("div",{className:"justify-center flex flex-wrap h-6 items-end",children:[Object(I.jsx)("div",{className:"mt-2",children:Object(I.jsx)(q,{className:"border border-black py-1 px-4 mx-1 bg-white"})}),Object(I.jsx)("div",{className:"mt-2",children:Object(I.jsx)(V,{className:"border border-black py-1 px-4 mx-1 bg-white whitespace-nowrap"})}),Object(I.jsx)("div",{className:"mt-2",children:Object(I.jsx)(Q,{className:"border border-black py-1 px-4 mx-1 bg-white"})}),Object(I.jsx)("div",{className:"mt-2",children:Object(I.jsx)("a",{className:"dchan-link border border-black py-1 px-4 mx-1 bg-white",href:"//github.com/dchan-network",target:"_blank",rel:"noreferrer",children:"git"})})]}),Object(I.jsx)("div",{className:"justify-end text-right px-6 text-xs text-gray-600 flex",children:Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{children:"v0.0.1"}),Object(I.jsx)("div",{children:Object(I.jsx)("a",{className:"dchan-link",href:"//github.com/dchan-network/dchan-client/issues/new",target:"_blank",rel:"noreferrer",children:"Report a bug"})}),Object(I.jsx)("div",{children:Object(I.jsx)(S,{})})]})})]})]})]})}var G=n(893),X=n(10),Z=n(13),K=function(){function e(){Object(X.a)(this,e)}return Object(Z.a)(e,null,[{key:"post",value:function(e){var t,n,c=e.n,a=e.board,r=e.thread,s=e.from,i=null===r||void 0===r||null===(t=r.op)||void 0===t||null===(n=t.from)||void 0===n?void 0:n.id;return a&&a&&a.name&&a.id?r&&i?"/".concat(a.name,"/").concat(a.id,"/").concat(i,"/").concat(r.n,"/").concat(s.id,"/").concat(c):"/".concat(a.name,"/").concat(a.id,"/").concat(s.id,"/").concat(c):void 0}},{key:"thread",value:function(e){var t=e.n,n=e.op,c=e.board;return c&&c.name&&c.id&&t?"/".concat(c.name,"/").concat(c.id,"/").concat(n.from.id,"/").concat(t):void 0}},{key:"board",value:function(e,t){var n=e.name,c=e.id,a=t&&["catalog","index"].includes(t)?"/".concat(t):"";return n&&c?"/".concat(n,"/").concat(c).concat(a):void 0}},{key:"posts",value:function(){return"/_/posts"}},{key:"boards",value:function(){return"/_/boards"}}]),e}(),$=n(183),ee=n.n($),te=n(412),ne={contract:{address:"0x5a139ee9f56c4F24240aF366807490C171922b0E".toLowerCase()},subgraph:{endpoint:"https://api.thegraph.com/subgraphs/name/dchan-network/dchan-alpha-0"},ipfs:{endpoint:"https://api.thegraph.com/ipfs/api/v0"},content_view:{page_size:25,board_default_view_mode:"catalog",board_sort_threads_by:"lastBumpedAt",board_sort_direction:"desc"},content_filter:{score_threshold:1,show_below_threshold:!1},autorefresh:{enabled:!0,seconds:10},eula:{agreed:!1},favorites:{}};function ce(e){var t=0===e.indexOf("0x")?2:0;return"".concat(e.substring(t,t+3),"-").concat(e.substring(e.length-3))}function ae(e,t){return JSON.stringify({ns:"dchan",v:0,op:e,data:t})}function re(e,t,n){return se.apply(this,arguments)}function se(){return(se=Object(x.a)(m.a.mark((function e(t,n,c){var a,r,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new ee.a(window.web3.currentProvider),r=new a.eth.Contract(te,ne.contract.address),e.next=4,r.methods.message(ae(t,n));case 4:return s=e.sent,e.abrupt("return",s.send({from:c}));case 6:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function ie(e,t,n){return oe.apply(this,arguments)}function oe(){return(oe=Object(x.a)(m.a.mark((function e(t,n,c){var a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=new ee.a(window.web3.currentProvider),r=c*Math.pow(10,18),e.abrupt("return",a.eth.sendTransaction({from:t,to:n,value:r}));case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function le(e){return de.apply(this,arguments)}function de(){return(de=Object(x.a)(m.a.mark((function e(t){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=new ee.a(window.web3.currentProvider),e.abrupt("return",n.eth.getBalance(t));case 2:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function be(e){return!!e&&("0x89"===e||137===e)}function je(e){var t,n=e.id,c=e.className,a=void 0===c?"":c,r=e.children,s=ce(n);return null==r&&(r=s),Object(I.jsx)("span",{style:{backgroundColor:(t=s,"#".concat(ce(t).replace("-","")))},className:[a,he].join(" "),children:r})}var ue,he="font-mono font-bold text-readable-anywhere pt-0.5 px-0.5 mx-0.5 rounded opacity-75 hover:opacity-100 text-xs whitespace-nowrap";function pe(e){var t=e.board,n=e.block;return Object(I.jsx)(l.b,{title:t.title,to:"".concat(K.board(t)).concat(n?"?block=".concat(n):""),children:Object(I.jsxs)(je,{id:t.id,children:["/",t.name,"/"]})})}var me,xe,Oe=Object(N.a)(ue||(ue=Object(y.a)(["\n  fragment Board on Board {\n    id\n    title\n    postCount\n    name\n    isLocked\n    isNsfw\n  }\n\n  query Boards {\n    boards(orderBy: postCount, orderDirection: desc, first: 10) {\n      ...Board\n    }\n  }\n"]))),fe=Object(N.a)(me||(me=Object(y.a)(["\n  query BlockByDate($timestampMin: String!, $timestampMax: String!) {\n    blocks(first: 1, orderBy: timestamp, orderDirection: asc,\n            where: {timestamp_gte: $timestampMin, timestamp_lte: $timestampMax}) {\n        timestamp\n        number\n    }\n}\n"]))),ve=Object(N.a)(xe||(xe=Object(y.a)(["\n  query BlockByNumber($number: BigInt!) {\n    blocks(first: 1, orderBy: timestamp, orderDirection: desc,\n            where: {number_lte: $number}) {\n        timestamp\n        number\n    }\n}\n"])));var ge,Ae=n(53),ke=n(31),we=n.n(ke);var ye,Ne,Ce,Be=Object(h.b)([void 0,void 0],(function(){var e=function(e,t){var n=Object(c.useState)((function(){try{var n=window.localStorage.getItem(e);return n?JSON.parse(n):t}catch(c){return console.log(c),t}})),a=Object(i.a)(n,2),r=a[0],s=a[1];return[r,function(t){try{var n=t instanceof Function?t(r):t;s(n),window.localStorage.setItem(e,JSON.stringify(n))}catch(c){console.error({error:c})}}]}("dchan.config",ne),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useCallback)((function(e){a(e),ge(e)}),[a]);return[Object(o.a)(Object(o.a)({},ne),n),r]})),Ie=Object(h.b)({},(function(){var e=Be(),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useMemo)((function(){return(null===n||void 0===n?void 0:n.favorites)||{}}),[n]),s=Object(c.useCallback)((function(e){a(Object(o.a)(Object(o.a)({},n),{},{favorites:Object(ke.omit)((null===n||void 0===n?void 0:n.favorites)||{},e.id)}))}),[n,a]),l=Object(c.useCallback)((function(e){a(Object(o.a)(Object(o.a)({},n),{},{favorites:Object(o.a)(Object(o.a)({},null===n||void 0===n?void 0:n.favorites),{},Object(Ae.a)({},e.id,!0))}))}),[n,a]);return{isFavorite:Object(c.useCallback)((function(e){return!!r[e.id]}),[r]),removeFavorite:s,addFavorite:l,favorites:r}})),Se=function(e,t){var n=t.watch,a=t.setValue,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},s=r.storage,o=void 0===s?window.localStorage:s,l=r.include,d=void 0===l?[]:l,b=r.onDataRestored,j=void 0===b?void 0:b,u=r.validate,h=void 0!==u&&u,p=r.dirty,m=void 0!==p&&p,x=Object(c.useState)(!1),O=Object(i.a)(x,2),f=O[0],v=O[1],g=n(d);return Object(c.useEffect)((function(){var t=o.getItem(e);if(!f&&t){var n=JSON.parse(t),c={};Object.keys(n).forEach((function(e){c[e]=n[e];var t=n[e];a(e,t,{shouldValidate:h,shouldDirty:!0})})),j&&j(c),v(!0)}}),[m,d,o,j,a,h,e,f,v]),Object(c.useEffect)((function(){if(g.filter((function(e){return!!e})).length>0){var t={};g.forEach((function(e,n){t[d[n]]=e})),o.setItem(e,JSON.stringify(t))}})),{clear:function(){return o.removeItem(e)}}},Ee=Object(N.a)(ye||(ye=Object(y.a)(["\n  query LatestBlock {\n    blocks(first: 1, orderBy: timestamp, orderDirection: desc) {\n        timestamp\n        number\n    }\n  }\n"]))),Te=Object(h.b)({},(function(){var e;return{lastBlock:null===(e=Object(v.a)(Ee,{pollInterval:1e4}).data)||void 0===e?void 0:e.blocks[0]}})),De=n(61),_e=Object(h.b)({publish:De.publish,subscribe:De.subscribe,unsubscribe:De.unsubscribe},(function(){return{publish:De.publish,subscribe:De.subscribe,unsubscribe:De.unsubscribe}})),Pe=Object(N.a)(Ne||(Ne=Object(y.a)(["\n  fragment User on User{\n    id\n    b58id\n    address\n  }\n"]))),He=Object(N.a)(Ce||(Ce=Object(y.a)(["\n  ","\n  query User($address: String!) {\n    admin(id: $address) {\n      id\n    }\n    user(id: $address) {\n      ...User\n      jannies {\n        board {\n          id\n        }\n      }\n    }\n  }\n"])),Pe),Le=n(901),Me=n(425),Qe=n(422),Re=n.n(Qe),Fe=Object(h.b)({provider:void 0,chainId:void 0,accounts:[],loadWeb3Modal:function(){var e=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),logoutOfWeb3Modal:function(){var e=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()},(function(){var e=Object(c.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(),s=Object(i.a)(r,2),o=s[0],l=s[1],d=Object(c.useState)([]),b=Object(i.a)(d,2),j=b[0],u=b[1],h=Object(c.useState)(!1),p=Object(i.a)(h,2),O=p[0],f=p[1],v=Object(c.useMemo)((function(){return new Re.a({network:"matic",cacheProvider:!0,providerOptions:{walletconnect:{package:Me.a}}})}),[]),g=Object(c.useCallback)(Object(x.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,v.connect();case 3:return t=e.sent,a(new Le.a(t)),l(window.ethereum.chainId),e.next=8,window.ethereum.request({method:"eth_accounts"});case 8:return n=e.sent,u(n),window.ethereum.on("accountsChanged",(function(e){0===e.length&&a(void 0),u(e)})),window.ethereum.on("chainChanged",(function(e){l(e)})),e.abrupt("return",{success:!0});case 15:return e.prev=15,e.t0=e.catch(0),e.abrupt("return",{success:!1});case 18:case"end":return e.stop()}}),e,null,[[0,15]])}))),[v]),A=Object(c.useCallback)(Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,v.clearCachedProvider();case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)}))),[v]);return Object(c.useEffect)((function(){!O&&v.cachedProvider&&(g(),f(!0))}),[true,O,g,f,v.cachedProvider]),{provider:n,chainId:o,accounts:j,loadWeb3Modal:g,logoutOfWeb3Modal:A}})),ze=function(){var e=Fe().accounts,t=e.length>0?e[0]:"",n=Object(v.a)(He,{variables:{address:t},skip:!t}),a=n.refetch,r=n.loading,s=n.data,i=Object(c.useCallback)((function(){var e;if(!r)return!!(null===s||void 0===s||null===(e=s.admin)||void 0===e?void 0:e.id)}),[r,s]),l=Object(c.useCallback)((function(e){var t,n;if(!r)return i()||!!(null===s||void 0===s||null===(t=s.user)||void 0===t||null===(n=t.jannies)||void 0===n?void 0:n.filter((function(t){var n=t.board;return(null===n||void 0===n?void 0:n.id)===e})).length)}),[i,r,s]);return Object(c.useEffect)((function(){a()}),[a]),Object(o.a)(Object(o.a)({},n),{},{isJannyOf:l,isAdmin:i})};var qe,We,Ue="You're currently viewing a past version of the board. The content is displayed as it was shown to users at the specified date.",Ye=Object(h.b)(void 0,(function(){var e=Object(c.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1];return qe=a,n})),Ve=Object(h.b)(void 0,(function(){var e=Object(c.useState)(),t=Object(i.a)(e,2),n=t[0],a=t[1];return We=function(e){a(e),qe(e)},n})),Je=Object(c.forwardRef)((function(e,t){var n=e.client,a=e.block,r=e.startBlock,s=e.dateTime,o=e.startRangeLabel,l=e.baseUrl,b=e.open,j=e.onOpen,u=e.onClose;a&&isNaN(parseInt(a))&&(a=void 0);var h=g.DateTime.now(),p=Object(d.f)(),m=Te().lastBlock,x=Object(c.useState)(),O=Object(i.a)(x,2),f=O[0],v=O[1],k=Ve();Ye();var w=Object(c.useState)(a),y=Object(i.a)(w,2),N=y[0],C=y[1],B=Object(c.useState)(s),S=Object(i.a)(B,2),E=S[0],T=S[1],D=Object(c.useState)(a),_=Object(i.a)(D,2),P=_[0],H=_[1],L=Object(c.useState)(!1),M=Object(i.a)(L,2),Q=M[0],R=M[1],F=Object(c.useCallback)((function(e){We(e),T(g.DateTime.fromSeconds(parseInt(e.timestamp)))}),[T]),z=Object(c.useCallback)((function(){null!=m&&(F(m),H(m.number),qe(void 0))}),[m,F,H]),q=Object(c.useCallback)((function(e){(function(e,t){return e.query({query:fe,variables:{timestampMin:"".concat(null===t||void 0===t?void 0:t.toSeconds().toFixed(0)),timestampMax:"".concat((((null===t||void 0===t?void 0:t.toSeconds())||0)+1e6).toFixed(0))}})})(n,e).then((function(e){var t,n,c=null===(t=e.data)||void 0===t||null===(n=t.blocks)||void 0===n?void 0:n[0];if(null!=c){var a=l?l.includes("?")?"".concat(l,"&block=").concat(c.number):"".concat(l,"?block=").concat(c.number):void 0;R(!0),C(c.number),a&&p.replace(a),R(!1),H("".concat(c.number)),F(c)}}))}),[F,H,p,l,R,n]),W=Object(c.useCallback)((function(e){var t=l?e?l.includes("?")?"".concat(l,"&block=").concat(e):"".concat(l,"?block=").concat(e):"".concat(l):void 0;R(!0),C(e||void 0),t&&p.replace(t),R(!1),e?function(e,t){return e.query({query:ve,variables:{number:t}})}(n,e).then((function(e){var t,n,c=null===(t=e.data)||void 0===t||null===(n=t.blocks)||void 0===n?void 0:n[0];F(c)})):z()}),[F,l,p,z,C,R,n]);Object(c.useEffect)((function(){a===N||Q?!a&&m&&k!==m?z():k||(null!=E?q(E):null!=P?W(P):z()):(C(a),a?(H(a),W(a)):z())}),[a,k,q,W,z,E,P,N,C,m,Q]),Object(c.useEffect)((function(){return function(){We(void 0)}}),[]),Object(c.useEffect)((function(){r&&m&&v({min:r,max:m})}),[r,m,v]);var U=Object(c.useCallback)((function(e){q(g.DateTime.fromISO(e))}),[q]),Y=Object(c.useMemo)((function(){return we.a.debounce(W,300)}),[W]),V=Object(c.useCallback)((function(e){H(e),Y(e)}),[H,Y]),J=Object(c.useCallback)((function(){W(null)}),[W]),G=Object(c.useCallback)((function(){if(null!=f){var e=prompt("Block number: (range: ".concat(f.min.number,"-").concat(f.max.number,")"),P);if(null!==e){var t=parseInt(e||"");isNaN(t)||t<parseInt(f.min.number)||t>parseInt(f.max.number)?alert("Invalid block number: ".concat(e)):(H(e),W(e))}}}),[f,P,H,W]),X=!(!a||!m||a===(null===m||void 0===m?void 0:m.number));return Object(I.jsxs)("details",{className:"sm:relative",open:b,ref:t,children:[Object(I.jsx)("summary",{className:"list-none cursor-pointer w-full mx-1 whitespace-nowrap",onClick:function(e){e.preventDefault()},children:f&&l?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("div",{className:"ml-2 hidden sm:block",children:[X?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsxs)("span",{title:Ue,onClick:function(){J(),u()},children:[Object(I.jsx)("div",{className:"inline-block animation-spin spin-faster animation-direction-reverse",children:"\u231b"})," Time traveled to"]})," "]}):null,Object(I.jsxs)("span",{onClick:j,className:"text-xs",children:["[",Object(I.jsx)("input",{required:!0,type:"date",id:"dchan-timetravel-date-input",value:(X&&E?E:h).toISODate(),onClick:function(e){b||j(),e.stopPropagation()},onChange:function(e){return U(e.target.value)},min:A(f.min.timestamp).toISODate(),max:A(f.max.timestamp).toISODate()}),","," ",Object(I.jsx)("span",{className:"inline-block min-w-3rem",children:(X&&E?E:h).toLocaleString(g.DateTime.TIME_SIMPLE)}),"]"]})]}),Object(I.jsx)("div",{className:"ml-2 sm:hidden",onClick:j,children:X?Object(I.jsx)("abbr",{title:Ue,children:"\u23f1\ufe0f"}):Object(I.jsx)("span",{children:"\u23f1\ufe0f"})})]}):null}),Object(I.jsx)("div",{className:"absolute w-screen sm:w-max top-7 sm:top-full sm:mt-1 left-0 right-0 sm:left-auto sm:right-0",children:f?Object(I.jsxs)("div",{className:"bg-primary border border-secondary-accent p-1",children:[Object(I.jsxs)("div",{className:"sm:hidden text-xs my-1 ml-2",children:[Object(I.jsx)("span",{className:"mr-2",children:X?Object(I.jsx)("abbr",{title:"You're currently viewing a past version of the board. The content is displayed as it was shown to users at the specified date.",children:"Time traveled to:"}):"Current time:"}),Object(I.jsxs)("span",{onClick:j,children:["[",Object(I.jsx)("input",{required:!0,type:"date",id:"dchan-timetravel-date-input",value:(X&&E?E:h).toISODate(),onChange:function(e){return U(e.target.value)},min:A(f.min.timestamp).toISODate(),max:A(f.max.timestamp).toISODate()}),","," ",Object(I.jsx)("span",{className:"inline-block min-w-3rem",children:(X&&E?E:h).toLocaleString(g.DateTime.TIME_SIMPLE)}),"]"]})]}),Object(I.jsxs)("div",{className:"grid align-center text-xs w-full",children:[Object(I.jsx)("button",{className:"dchan-link",onClick:G,children:"Block #".concat(P||"?")}),X?Object(I.jsxs)("div",{className:"text-xs text-center",children:["[",Object(I.jsx)("button",{className:"dchan-link",onClick:J,children:"Return to present"}),"]"]}):Object(I.jsx)("div",{className:"mb-4"})]}),Object(I.jsxs)("div",{className:"text-xs bg-primary",children:[Object(I.jsxs)("div",{className:"grid grid-cols-4 center text-center",children:[Object(I.jsx)("span",{className:"mx-1",children:o}),Object(I.jsx)("input",{className:"col-span-2",id:"timetravel",type:"range",min:parseInt(f.min.number),max:parseInt(f.max.number),onChange:function(e){return V(e.target.value)},value:P})," ",Object(I.jsx)("span",{className:"mx-1",children:"Now"})]}),Object(I.jsxs)("div",{className:"grid grid-cols-4 center text-center",children:[Object(I.jsxs)("span",{className:"mx-1",children:[Object(I.jsx)("div",{children:A(f.min.timestamp).toLocaleString(g.DateTime.DATETIME_SHORT)}),Object(I.jsxs)("div",{children:["#",f.min.number]})]}),Object(I.jsx)("span",{className:"col-span-2"}),Object(I.jsxs)("span",{className:"mx-1",children:[Object(I.jsx)("div",{children:A(f.max.timestamp).toLocaleString(g.DateTime.DATETIME_SHORT)}),Object(I.jsxs)("div",{children:["#",f.max.number]})]})]})]})]}):Object(I.jsx)("div",{className:"bg-primary border border-secondary-accent p-1",children:"Cannot time travel here."})})]})}));function Ge(e){var t=e.baseUrl,n=e.search,a=Object(d.f)(),r=Object(c.useState)(n||""),s=Object(i.a)(r,2),o=s[0],l=s[1],b=Object(c.useCallback)((function(e){var n=e?t.includes("?")?"".concat(t,"&s=").concat(e):"".concat(t,"?s=").concat(e):t;a.push(n)}),[a,t]),j=Object(c.useMemo)((function(){return Object(ke.debounce)(b,500)}),[b]),u=Object(c.useCallback)((function(e){l(e),j(e)}),[j]);return Object(I.jsxs)("div",{className:"text-center bg-primary border border-secondary-accent p-1",children:[Object(I.jsx)("div",{children:"Search:"}),Object(I.jsx)("div",{children:Object(I.jsx)("input",{id:"dchan-search",className:"text-center w-32",type:"text",placeholder:"...",value:o,onChange:function(e){return u(e.target.value)},autoFocus:!0})}),Object(I.jsx)("div",{className:"relative",children:n?Object(I.jsxs)("span",{className:"text-xs",children:["[",Object(I.jsx)("button",{className:"dchan-link",onClick:function(){return b("")},children:"Cancel"}),"]"]}):""})]})}var Xe,Ze,Ke,$e,et=n(182),tt=Object(N.a)(Xe||(Xe=Object(y.a)(["\n  ","\n\n  fragment Post on Post{\n    id\n    n\n    from {\n      ...User\n    }\n    thread {\n      board {\n        id\n        name\n        isNsfw\n      }\n      id\n      n\n      op {\n        from {\n          ...User\n        }\n      }\n    }\n    board {\n      id\n      name\n      isNsfw\n    }\n    name\n    comment\n    image {\n      id\n      name\n      ipfsHash\n      score\n      isSpoiler\n      isNsfw\n    }\n    createdAt\n    createdAtBlock {\n      timestamp\n      number\n    }\n    bans {\n      ban {\n        reason\n        expiresAt\n      }\n    }\n    score\n    sage\n  }\n"])),Pe),nt=Object(N.a)(Ze||(Ze=Object(y.a)(["\n  ","\n  ","\n\n  fragment Thread on Thread{\n    id\n    n\n    isPinned\n    isLocked\n    from {\n      ...User\n    }\n    op {\n      ...Post\n    }\n    board {\n      id\n      name\n      isNsfw\n    }\n    subject\n    replyCount\n    imageCount\n    score\n    createdAt\n    createdAtBlock {\n      timestamp\n      number\n    }\n  }\n"])),tt,Pe),ct=Object(N.a)(Ke||(Ke=Object(y.a)(["\n  ","\n\n  query Threads($ids: [String!]!) {\n    threads(orderBy: lastBumpedAt, orderDirection: desc, where: {id_in: $ids}) {\n      ...Thread\n      replies(first: 3, orderBy: n, orderDirection: desc) {\n        ...Post\n      }\n    }\n  }\n"])),nt),at=n.p+"static/media/dchan.35747f56.png",rt=function(e){var t=e.speed,n=void 0===t?"slow":t,c=e.size,a=void 0===c?16:c;return Object(I.jsx)("span",{className:"center flex",children:Object(I.jsx)("img",{className:"spin-".concat(n," h-").concat(a," w-").concat(a," animation-spin pointer-events-none"),src:at,alt:""})})};function st(e){var t=e.className,n=void 0===t?"":t;return Object(I.jsxs)("div",{className:"".concat(n," grid center"),children:[Object(I.jsx)(rt,{speed:"sanic"}),Object(I.jsx)("div",{children:"Loading..."})]})}function it(e){var t=e.block,n=Ie(),a=n.favorites,r=n.removeFavorite,s=Object(c.useMemo)((function(){return a?Object.keys(a):[]}),[a]),i=Object(v.a)(ct,{pollInterval:3e4,variables:{ids:s},skip:!a}),o=i.data,d=i.loading,b=i.refetch,j=null===o||void 0===o?void 0:o.threads,u=Object(c.useCallback)((function(){return b({ids:s})}),[b,s]),h=Object(et.a)(u,1,!0),p=r||function(){};return a?Object(I.jsx)("div",{className:"bg-primary border border-secondary-accent p-1",children:d?Object(I.jsx)(st,{}):s.length>0&&j&&j.length>0?Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{className:"mb-2",children:["Watched threads:",Object(I.jsxs)("span",{className:"text-xs pl-2",children:["[",Object(I.jsx)("button",{className:"dchan-link",onClick:h,children:"Refresh"}),"]"]})]}),Object(I.jsx)("div",{className:"text-sm",children:j.map((function(e){var n=e.board;return Object(I.jsxs)("div",{children:[Object(I.jsx)("button",{onClick:function(){return p(e)},children:"\u2716"})," ",n?Object(I.jsx)("span",{children:Object(I.jsx)(pe,{board:n,block:t})}):"",Object(I.jsxs)(l.b,{className:"dchan-link",to:"".concat(K.thread(e)),children:[" ","- (",e.replyCount,") -"," ",Object(ke.truncate)(e.subject||e.op.comment,{length:32})," ",e.isLocked?"\ud83d\udd12":""," ",e.isPinned?"\ud83d\udccc":""]})]},e.id)}))})]}):"No threads are being watched. Use the \ud83d\udc41 button on threads to keep track of them here."}):Object(I.jsx)("div",{className:"bg-primary border border-secondary-accent p-1",children:"..."})}!function(e){e.TIMETRAVEL="TIMETRAVEL",e.SEARCH="SEARCH",e.WATCHEDTHREADS="WATCHEDTHREADS",e.SETTINGS="SETTINGS"}($e||($e={}));var ot={id:"0x04eeaa77c96947c5efca4abd8e3f8de005369390409d79dfef81aa983eb69e89",number:"17766365",timestamp:"1628450632"},lt=D((function(e){var t,n=e.onExit,a=Be(),r=Object(i.a)(a,2),s=r[0],l=r[1],d=Object(c.useState)(null===s||void 0===s||null===(t=s.content_filter)||void 0===t?void 0:t.score_threshold),b=Object(i.a)(d,2),j=b[0],u=b[1],h=Object(c.useMemo)((function(){return Object(ke.debounce)((function(e,t){var n=Object(o.a)({},e);e.content_filter.score_threshold=t,l(n)}),500)}),[l]);return s?Object(I.jsxs)("div",{className:"bg-secondary border-secondary-accent border-2 flex flex-col h-full",children:[Object(I.jsxs)("div",{className:"mb-2 mt-1 px-3",style:{flex:"0 1 auto"},children:[Object(I.jsx)("div",{className:"float-left",children:Object(I.jsx)("span",{className:"font-bold",children:"dchan Settings"})}),Object(I.jsx)("div",{className:"float-right",children:Object(I.jsx)("button",{onClick:n,children:"\u274c"})})]}),Object(I.jsx)("div",{className:"h-full overflow-y-scroll overscroll-contain",style:{flex:"1 1 auto"},children:Object(I.jsxs)("fieldset",{className:"border border-secondary-accent rounded px-4 pb-2 mx-2",children:[Object(I.jsx)("legend",{className:"font-bold",children:"Filter Settings"}),Object(I.jsxs)("div",{className:"text-contrast",children:["\u26a0 By disabling/changing filters, it's possible you may view/download highly disturbing content, or content which may be illegal in your jurisdiction.",Object(I.jsx)("div",{children:"Do so at your own risk."})]}),Object(I.jsx)("input",{id:"dchan-input-show-below-threshold",className:"mx-1 text-xs whitespace-nowrap opacity-80 hover:opacity-100",type:"checkbox",checked:s.content_filter.show_below_threshold,onChange:function(e){var t=Object(o.a)({},s);s.content_filter.show_below_threshold=e.target.checked,l(t)}}),Object(I.jsx)("label",{htmlFor:"dchan-input-show-below-threshold",children:"Show hidden content"}),Object(I.jsx)("br",{}),Object(I.jsx)("label",{htmlFor:"dchan-input-score-threshold",children:"Score hide threshold"}),Object(I.jsx)("div",{children:Object(I.jsx)("input",{id:"dchan-input-score-threshold",className:"mx-1 text-xs whitespace-nowrap opacity-80 hover:opacity-100",type:"range",min:0,max:1,step:.1,value:j,onChange:function(e){var t=parseFloat(e.target.value);u(t),h(s,t)}})}),Object(I.jsx)("div",{className:"text-sm",children:{0:"Show everything",.1:"Hide heavily reported content",.2:"Hide heavily reported content",.3:"Hide heavily reported content",.4:"Hide reported content",.5:"Hide reported content",.6:"Hide reported content",.7:"Hide slighly reported content",.8:"Hide slighly reported content",.9:"Hide slighly reported content",1:"Only show content with no reports"}[null!==j&&void 0!==j?j:"1"]})]})})]}):null}));function dt(e){var t=e.block,n=e.dateTime,a=e.board,r=e.thread,s=e.baseUrl,o=e.search,d=Object(c.useState)(),b=Object(i.a)(d,2),j=b[0],u=b[1],h=Object(c.useState)(null),p=Object(i.a)(h,2),m=p[0],x=p[1],O=Object(c.useRef)(null),f=Object(c.useRef)(null),g=Object(c.useRef)(null),A=Object(c.useRef)(null);Object(c.useEffect)((function(){u(r?r.createdAtBlock:a?a.createdAtBlock:ot)}),[r,a,u]),Object(c.useEffect)((function(){var e=function(e){[O,f,g,A].every((function(t){return t.current&&!t.current.contains(e.target)}))&&x(null)};return document.addEventListener("mousedown",e),function(){document.removeEventListener("mousedown",e)}}),[O,f,g,A]);var k=Object(v.a)(Oe,{variables:{},pollInterval:3e4}).data,w=null===k||void 0===k?void 0:k.boards;return Object(I.jsx)("div",{className:"mb-8",children:Object(I.jsxs)("div",{className:"text-sm p-1 border-solid border-bottom-secondary-accent bg-primary border-0 border-b-2 text-left fixed top-0 left-0 right-0 shadow-md z-50",children:["[",Object(I.jsx)(l.b,{className:"dchan-link",to:"/".concat(t?"?block=".concat(t):""),children:"dchan.network"}),"]",Object(I.jsxs)("span",{className:"text-black text-opacity-50",children:[Object(I.jsxs)("span",{className:"hidden sm:inline-block",children:["[",!!w&&w.map((function(e){return Object(I.jsxs)("span",{className:"dchan-navigation-board",children:[Object(I.jsx)("wbr",{}),Object(I.jsx)(pe,{board:e,block:t})]},e.id)})),"]"]}),"[",Object(I.jsx)(l.b,{className:"dchan-link",to:"".concat(K.boards()).concat(t?"?block=".concat(t):""),children:"+"}),"]"]}),Object(I.jsxs)("span",{className:"float-right flex flex-row",children:[Object(I.jsx)(G.a,{children:function(e){return Object(I.jsx)(Je,{client:e,ref:O,open:m===$e.TIMETRAVEL,onOpen:function(){x(m===$e.TIMETRAVEL?null:$e.TIMETRAVEL)},onClose:function(){return x(null)},block:t,baseUrl:s||"",startBlock:j,dateTime:n,startRangeLabel:r?"Thread creation":a?"Board creation":"Site creation"})}}),Object(I.jsxs)("details",{className:"w-full sm:relative mx-1",open:m===$e.SEARCH,ref:f,children:[Object(I.jsx)("summary",{className:"list-none cursor-pointer",onClick:function(e){e.preventDefault(),x(m===$e.SEARCH?null:$e.SEARCH)},children:"\ud83d\udd0d"}),Object(I.jsx)("div",{className:"absolute w-screen sm:w-max top-7 sm:top-full sm:mt-1 left-0 right-0 sm:left-auto sm:right-0",children:Object(I.jsx)(Ge,{baseUrl:"".concat(K.posts()).concat(t?"?block=".concat(t):""),search:o})})]}),Object(I.jsxs)("details",{className:"w-full sm:relative mx-1",open:m===$e.WATCHEDTHREADS,ref:g,children:[Object(I.jsx)("summary",{className:"list-none cursor-pointer",onClick:function(e){e.preventDefault(),x(m===$e.WATCHEDTHREADS?null:$e.WATCHEDTHREADS)},children:"\ud83d\udc41"}),Object(I.jsx)("div",{className:"absolute w-screen sm:w-max top-7 sm:top-full sm:mt-1 left-0 right-0 sm:left-auto sm:right-0",children:Object(I.jsx)(it,{block:t})})]}),Object(I.jsxs)("span",{ref:A,className:"cursor-pointer mx-1",onClick:function(){x(m===$e.SETTINGS?null:$e.SETTINGS)},children:["\u2699\ufe0f",m===$e.SETTINGS?Object(I.jsx)(lt,{onExit:function(){return x(null)},overlayClassName:"w-full sm:w-4/6 h-5/6"}):""]})]})]})})}var bt=function(){return Object(I.jsx)(l.b,{to:"/",children:Object(I.jsxs)("span",{className:"h-24 font-mono center grid grid-cols-2 relative",children:[Object(I.jsx)("span",{className:"text-right mr-8",children:"dchan"}),Object(I.jsx)("span",{className:"absolute left-0 right-0 bottom-0 top-0 m-auto h-16",children:Object(I.jsx)(rt,{size:16})}),Object(I.jsx)("span",{className:"text-left ml-8",children:"network"})]})})},jt=function(e){var t=e.title,n=e.baseUrl,c=e.block,a=e.dateTime;return Object(I.jsxs)("header",{children:[Object(I.jsx)(dt,{baseUrl:n,block:c,dateTime:a}),Object(I.jsx)(bt,{}),Object(I.jsx)("div",{className:"text-4xl text-contrast font-weight-800 font-family-tahoma",children:t}),Object(I.jsx)("div",{className:"p-2",children:Object(I.jsx)("hr",{})})]})};function ut(e){var t=e.ms,n=void 0===t?1e4:t,a=e.children,r=Object(c.useState)(!1),s=Object(i.a)(r,2),o=s[0],l=s[1];return setTimeout((function(){l(!0)}),n),o?a:Object(I.jsx)("span",{})}function ht(){var e=Object(c.useState)(!1),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),s=Object(i.a)(r,2),o=s[0],l=s[1],d=Fe(),b=d.provider,j=d.loadWeb3Modal,u=d.logoutOfWeb3Modal,h=Object(c.useCallback)(Object(x.a)(m.a.mark((function e(){var t,n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,b){e.next=11;break}return a(!0),e.next=5,j();case 5:t=e.sent,n=t.success,l(!n),a(!1),e.next=12;break;case 11:u();case 12:e.next=17;break;case 14:e.prev=14,e.t0=e.catch(0),console.error({onClickError:e.t0});case 17:case"end":return e.stop()}}),e,null,[[0,14]])}))),[b,j,u,a,l]);return Object(I.jsxs)("div",{children:[Object(I.jsxs)("div",{children:["[",Object(I.jsx)("button",{className:"dchan-link",onClick:h,children:n?"Connecting wallet...":b?"Disconnect Wallet":"Connect Wallet"}),"]"]}),Object(I.jsxs)("span",{className:"text-sm",children:[o?Object(I.jsxs)("span",{children:["\u26a0\ufe0f Something went wrong. ",Object(I.jsx)("br",{}),"Check that your wallet is unlocked and doesn't have any pending modals, then try again."]}):"",!o&&n?Object(I.jsx)(ut,{ms:2e3,children:Object(I.jsx)("span",{children:"If the above button does not work, try unlocking your wallet first, then retry."})}):""]}),b?"":Object(I.jsx)("div",{className:"text-xs px-2",children:Object(I.jsxs)("small",{className:"p-1 text-center",children:[Object(I.jsx)("div",{children:"You need to connect your wallet to interact with dchan."}),Object(I.jsxs)("div",{children:["Works with"," ",Object(I.jsx)("a",{className:"dchan-link",href:"//metamask.io",children:"Metamask"})," ","(for Desktop) or"," ",Object(I.jsx)("a",{className:"dchan-link",href:"//trustwallet.com/",children:"Trust Wallet"})," ","(for Mobile)."]}),Object(I.jsx)("div",{children:"Other wallets might not be supported."})]})})]})}function pt(){var e=ze().isAdmin,t=Fe().accounts;Object(c.useEffect)((function(){window.scrollTo({top:0})}),[]);var n=function(){var e=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re("admin:claim",{},t[0]);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),a=function(){var e=Object(x.a)(m.a.mark((function e(){var n;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=prompt("Whomst 0x?"),alert("Granting admin to ".concat(n)),e.next=4,re("admin:grant",{hex_address:n},t[0]);case 4:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),r=function(){var e=Object(x.a)(m.a.mark((function e(){var n,c,a,r;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=prompt("IPFS hash?"),c=prompt("Version?"),a=prompt("Channel?")||"",r=!!n&&!!c,alert("".concat(r?"Publishing":"Invalid"," '").concat(n,"', version '").concat(c,"' on channel '").concat(a,"'")),e.next=7,r;case 7:if(e.t0=e.sent,!e.t0){e.next=10;break}re("client:publish",{ipfs_hash:n,version:c,channel:a},t[0]);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),s=function(){var e=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re("chan:lock",{},t[0]);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),i=function(){var e=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,re("chan:unlock",{},t[0]);case 2:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return Object(I.jsxs)("div",{className:"bg-primary min-h-100vh",children:[Object(I.jsx)(jt,{title:"Admin panel"}),Object(I.jsx)(ht,{}),e()?Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)("button",{onClick:r,children:"Publish Client"})}),Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)("button",{onClick:n,children:"Claim Admin"})}),Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)("button",{onClick:a,children:"Grant Admin"})}),Object(I.jsxs)("div",{className:"center grid",children:[Object(I.jsx)("button",{onClick:s,children:"Lock"}),Object(I.jsx)("button",{onClick:i,children:"Unlock"})]}),Object(I.jsx)(l.b,{className:"m-4 dchan-link",to:"/",children:"Home"}),Object(I.jsx)(J,{})]}):""]})}var mt=n(32);function xt(e){var t=e.className,n=void 0===t?"":t,a=e.loading,r=void 0!==a&&a,s=e.boards,i=e.block;return Object(I.jsx)("div",{className:"".concat(n," center overflow-auto"),children:Object(I.jsx)("table",{className:"mx-8 border-separate",children:Object(I.jsx)("tbody",{children:r?Object(I.jsx)(st,{}):s?s.length>0?s.map((function(e){return function(e){var t=e.board,n=e.block,a=t.id,r=t.title,s=t.postCount,i=t.name,o=t.isLocked,d=t.isNsfw,b=_e().publish,j=Object(c.useCallback)((function(){b("BOARD_ITEM_HOVER_ENTER",t)}),[t,b]),u=Object(c.useCallback)((function(){b("BOARD_ITEM_HOVER_LEAVE",t)}),[t,b]);return Object(I.jsxs)("tr",{className:"relative",onMouseEnter:j,onMouseLeave:u,children:[Object(I.jsx)("td",{children:Object(I.jsx)(je,{id:a})}),Object(I.jsx)("td",{className:"px-2 whitespace-nowrap hidden sm:block max-w-12rem truncate",children:Object(I.jsx)("span",{children:Object(I.jsx)(l.b,{className:"dchan-link",to:"/".concat(i,"/").concat(a).concat(n?"?block=".concat(n):""),children:r})})}),Object(I.jsx)("td",{className:"px-2 whitespace-nowrap",children:Object(I.jsx)("span",{children:Object(I.jsxs)(l.b,{className:"dchan-link mx-4",to:"/".concat(i,"/").concat(a).concat(n?"?block=".concat(n):""),children:["/",i,"/"]})})}),Object(I.jsx)("td",{className:"px-2 whitespace-nowrap text-right",children:Object(I.jsxs)("span",{children:[s," posts"]})}),Object(I.jsxs)("td",{className:"left-full top-0 px-1 whitespace-nowrap center block",children:[o?Object(I.jsx)("span",{title:"Board locked. You cannot post.",children:"\ud83d\udd12"}):"",d?Object(I.jsx)("span",{title:"NSFW Board",children:"\ud83d\udd1e"}):""]})]},a)}({board:e,block:i})})):"No boards":""})})})}function Ot(e,t,n){return ft.apply(this,arguments)}function ft(){return(ft=Object(x.a)(m.a.mark((function e(t,n,c){var a,r,s,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!t){e.next=27;break}if(!(a=t[0])){e.next=27;break}return n({progress:"Uploading image..."}),e.prev=4,(r=new FormData).append("file",a),e.next=9,fetch("".concat(c||ne.ipfs.endpoint,"/add"),{method:"POST",body:r,referrer:""});case 9:return s=e.sent,e.next=12,s.json();case 12:if(i=e.sent,console.log({ipfs:i}),!i.Hash){e.next=19;break}return n({success:"File uploaded"}),e.abrupt("return",{ipfs:{hash:i.Hash},name:i.Name});case 19:i.error?n({error:i.error}):n({error:"File upload failed!"});case 20:e.next=27;break;case 22:return e.prev=22,e.t0=e.catch(4),console.error({ipfsUpload:e.t0}),n({error:"File upload failed!"}),e.abrupt("return");case 27:case"end":return e.stop()}}),e,null,[[4,22]])})))).apply(this,arguments)}function vt(e,t,n,c){return gt.apply(this,arguments)}function gt(){return(gt=Object(x.a)(m.a.mark((function e(t,n,c,a){var r,s,i,l,d,b,j,u,h,p;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.board,s=t.thread,i=t.comment,l=t.name,d=t.subject,b=t.sage,j=t.nonce,!(t.file.length>0)){e.next=9;break}return c({progress:"Uploading file..."}),e.next=5,Ot(t.file,c,a);case 5:if(u=e.sent){e.next=9;break}return c({error:"Upload failed"}),e.abrupt("return");case 9:return h={comment:i,name:l,nonce:j},u&&(h.file=Object(o.a)(Object(o.a)({},u),{},{is_nsfw:t.is_nsfw,is_spoiler:t.is_spoiler})),s?h.thread=s:h.subject=d,r&&(h.board=r),b&&(h.sage=!0),c({progress:"Waiting tx confirmation..."}),e.next=17,re("post:create",h,n[0]);case 17:return p=e.sent,c({success:"Sent ;)"}),e.abrupt("return",p);case 20:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function At(){return(At=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Removing..."}),e.next=4,re("post:remove",{id:t},n[0]);case 4:c({success:"Removed"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function kt(){return(kt=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Reporting..."}),e.next=4,re("post:report",{id:t},n[0]);case 4:c({success:"Reported"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function wt(e,t,n){return yt.apply(this,arguments)}function yt(){return(yt=Object(x.a)(m.a.mark((function e(t,n,c){var a;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Creating..."}),e.next=4,re("board:create",t,n[0]);case 4:return a=e.sent,c({success:"Created"}),e.abrupt("return",a);case 9:e.prev=9,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 13:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function Nt(){return(Nt=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Removing..."}),e.next=4,re("board:remove",{id:t},n[0]);case 4:c({success:"Removed"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Ct(){return(Ct=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Locking..."}),e.next=4,re("board:lock",{id:t},n[0]);case 4:c({success:"Locked"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Bt(){return(Bt=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Unlocking..."}),e.next=4,re("board:unlock",{id:t},n[0]);case 4:c({success:"Unlocked"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function It(){return(It=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Locking..."}),e.next=4,re("thread:lock",{id:t},n[0]);case 4:c({success:"Locked"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function St(){return(St=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Unlocking..."}),e.next=4,re("thread:unlock",{id:t},n[0]);case 4:c({success:"Unlocked"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Et(){return(Et=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Pinning..."}),e.next=4,re("thread:pin",{id:t},n[0]);case 4:c({success:"Pinned"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Tt(){return(Tt=Object(x.a)(m.a.mark((function e(t,n,c){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,c({progress:"Unpinning..."}),e.next=4,re("thread:unpin",{id:t},n[0]);case 4:c({success:"Unpinned"}),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 11:case"end":return e.stop()}}),e,null,[[0,7]])})))).apply(this,arguments)}function Dt(){return(Dt=Object(x.a)(m.a.mark((function e(t,n,c){var a,r,s,i;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,c({progress:"Banning..."}),a=window.prompt("How many seconds?"),r=parseInt(a||""),!isNaN(r)){e.next=7;break}return c({error:"Not a number: ".concat(a)}),e.abrupt("return");case 7:if(s=window.prompt("Reason?"),i=g.DateTime.fromSeconds(g.DateTime.now().toSeconds()+r),!window.confirm("Banning until ".concat(i.toISO()))){e.next=15;break}return e.next=12,re("post:ban",{id:t,seconds:r,reason:s},n[0]);case 12:c({success:"Banned"}),e.next=16;break;case 15:c("Canceled");case 16:e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),c({error:e.t0}),console.error({error:e.t0});case 22:case"end":return e.stop()}}),e,null,[[0,18]])})))).apply(this,arguments)}var _t=n(180);function Pt(){var e=Fe(),t=e.accounts,n=e.provider,a=Object(d.f)(),r=Object(c.useState)(),s=Object(i.a)(r,2),l=s[0],b=s[1],j=Object(c.useState)(!1),u=Object(i.a)(j,2),h=u[0],p=u[1],O=Object(_t.a)(),f=O.register,v=O.handleSubmit,g=function(){var e=Object(x.a)(m.a.mark((function e(n){var c,r,s,i,o,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return p(!0),e.next=3,wt(n,t,b);case 3:c=e.sent,(r=null===c||void 0===c?void 0:c.events)&&r.length>0&&(s=r[0],i=s.transactionHash,o=s.logIndex,l="/".concat(i,"-").concat(o),a.push(l)),p(!1);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(I.jsx)(E,{title:Object(I.jsx)("span",{children:"Create a board!"}),className:"pt-4",children:Object(I.jsxs)("form",{onSubmit:v(g),children:[Object(I.jsx)(ht,{}),Object(I.jsx)("div",{className:"border center flex",children:n?Object(I.jsxs)("tr",{className:"p-4 text-center",children:[Object(I.jsx)("td",{className:"px-2",children:Object(I.jsx)("input",Object(o.a)({className:"text-center",type:"text",placeholder:"Videogames",maxLength:70},f("title")))}),Object(I.jsxs)("td",{className:"px-2",children:["/",Object(I.jsx)("input",Object(o.a)({className:"text-center w-16",type:"text",placeholder:"v",maxLength:7},f("name"))),"/"]}),Object(I.jsxs)("td",{className:"px-2",children:[Object(I.jsx)("input",Object(o.a)({id:"dchan-input-is_nsfw",className:"mx-1",type:"checkbox"},f("nsfw"))),Object(I.jsx)("label",{htmlFor:"dchan-input-is_nsfw",className:"text-black font-weight-800 font-family-tahoma",children:"NSFW"})]}),Object(I.jsx)("td",{className:"px-2",children:Object(I.jsx)("button",{className:"px-2 mx-1 bg-gray-100 border",type:"submit",disabled:h,children:"string"===typeof l?l:"Create"})})]}):Object(I.jsx)("tr",{})})]})})}function Ht(e){var t=e.children,n=e.className,r=void 0===n?"":n,s=e.containerClassName,o=void 0===s?"":s,l=Object(c.useState)(t.keys().next().value),d=Object(i.a)(l,2),b=d[0],j=d[1],u=b;return t.has(b)||(u=t.keys().next().value),Object(I.jsxs)("article",{className:"".concat(r),children:[Object(I.jsx)("header",{className:"bg-white border border-black flex flex-row justify-evenly",style:{flex:"0 1 auto"},children:Array.from(t.keys()).map((function(e,n){return Object(I.jsxs)(a.a.Fragment,{children:[Object(I.jsx)("button",{className:["bg-highlight py-1 px-4 w-full font-bold",e===u?"opacity-100":"opacity-80 hover:opacity-100"].join(" "),onClick:function(){j(e)},children:e}),n<t.size-1?Object(I.jsx)("div",{className:"border-l border-black"}):null]},e)}))}),Object(I.jsx)("section",{className:"bg-white h-full border border-black flex flex-col border-t-0 p-4 overflow-y-auto",style:{flex:"1 1 auto"},children:Object(I.jsx)("div",{className:o,children:Array.from(t.entries()).map((function(e){var t=Object(i.a)(e,2),n=t[0],c=t[1];return Object(I.jsx)("div",{className:["",n!==u?"hidden":""].join(" "),style:{flex:"0 0 auto"},children:c},n)}))})}),Object(I.jsx)("div",{})]})}var Lt,Mt,Qt,Rt,Ft,zt=n(72),qt=Object(N.a)(Lt||(Lt=Object(y.a)(["\n  ","\n\n  fragment Board on Board{\n    id\n    title\n    threadCount\n    postCount\n    name\n    isLocked\n    isNsfw\n    createdAt\n    createdAtBlock {\n      timestamp\n      number\n    }\n    lastBumpedAtBlock {\n      timestamp\n      number\n    }\n    jannies {\n      user {\n        ...User\n      }\n    }\n  }\n"])),Pe),Wt=Object(N.a)(Mt||(Mt=Object(y.a)(["\n  ",'\n  \n  query Boards {\n    mostPopular: boards(orderBy: postCount, orderDirection: desc, where: {score_gt: "900000000"}) {\n      ...Board\n    }\n    lastBumped: boards(orderBy: lastBumpedAt, orderDirection: desc, where: {score_gt: "900000000"}) {\n      ...Board\n    }\n    lastCreated: boards(orderBy: createdAt, orderDirection: desc, where: {score_gt: "900000000"}) {\n      ...Board\n    }\n  }\n'])),qt),Ut=Object(N.a)(Qt||(Qt=Object(y.a)(["\n  ",'\n  \n  query Boards($block: Int) {\n    mostPopular: boards(orderBy: postCount, orderDirection: desc, where: {score_gt: "900000000"}, block: {number: $block}) {\n      ...Board\n    }\n    lastBumped: boards(orderBy: lastBumpedAt, orderDirection: desc, where: {score_gt: "900000000"}, block: {number: $block}) {\n      ...Board\n    }\n    lastCreated: boards(orderBy: createdAt, orderDirection: desc, where: {score_gt: "900000000"}, block: {number: $block}) {\n      ...Board\n    }\n  }\n'])),qt),Yt=Object(N.a)(Rt||(Rt=Object(y.a)(["\n  ","\n\n  query BoardsSearch($searchName: String!, $searchTitle: String!) {\n    searchByTitle: boardSearch(text: $searchTitle) {\n      ...Board\n    }\n    searchByName: boards(where: {name: $searchName}) {\n      ...Board\n    }\n  }\n"])),qt);function Vt(e){var t=e.location,n=e.match.params,a=Object(zt.parse)(t.search),r="".concat((null===n||void 0===n?void 0:n.board_name)||"")||(Object(ke.isString)(a.s)?a.s:""),s=parseInt("".concat(a.block)),i=isNaN(s)?void 0:s,o=a.date?g.DateTime.fromISO(a.date):void 0,l=Object(v.a)(Yt,{pollInterval:3e4,fetchPolicy:i?"cache-first":"network-only",variables:{searchName:r,searchTitle:r.length>1?"".concat(r,":*"):"",block:i},skip:!r}),d=l.refetch,b=l.data,j=l.loading,u=Object(v.a)(s?Ut:Wt,{pollInterval:3e4,fetchPolicy:i?"cache-first":"network-only",variables:{block:i}}),h=u.data,p=u.loading;Object(c.useEffect)((function(){d()}),[r,d]),Object(c.useEffect)((function(){window.scrollTo({top:0})}),[r]);var m=b&&(b.searchByTitle||b.searchByName)?Object(ke.uniqBy)([].concat(Object(mt.a)(b.searchByName),Object(mt.a)(b.searchByTitle)),"id"):[];return Object(I.jsxs)("div",{className:"bg-primary min-h-100vh flex flex-col",children:[Object(I.jsx)(jt,{title:"Boards",baseUrl:"".concat(K.boards()).concat(r?"?s=".concat(r):""),block:i?"".concat(i):void 0,dateTime:o}),Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"flex center",children:Object(I.jsx)(Ge,{baseUrl:"".concat(K.boards()).concat(i?"?block=".concat(i):""),search:r})}),j||p?Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)(st,{})}):r?Object(I.jsx)("div",{className:"center flex",children:Object(I.jsx)("div",{className:"p-2",children:m.length>0?Object(I.jsx)(E,{title:Object(I.jsxs)("span",{children:['Results for "',r,'"']}),className:"pt-4",children:Object(I.jsx)(xt,{boards:m,block:i})}):"No boards found"})}):h?Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("div",{className:"flex flex-col justify-center",children:Object(I.jsx)(Ht,{className:"w-screen sm:w-auto mt-4 sm:mx-auto",children:new Map([["Most popular",Object(I.jsx)(xt,{boards:h.mostPopular,block:i})],["Last created",Object(I.jsx)(xt,{boards:h.lastCreated,block:i})],["Last bumped",Object(I.jsx)(xt,{boards:h.lastBumped,block:i})]])})}),Object(I.jsx)("div",{className:"center flex",children:Object(I.jsx)("div",{children:Object(I.jsx)(Pt,{})})})]}):""]}),Object(I.jsx)(J,{})]})}var Jt,Gt=Object(N.a)(Ft||(Ft=Object(y.a)(["\n  ","\n  ","\n  \n  query BoardCatalog($board: String!, $block: Int!, $orderBy: String!, $orderDirection: String!, $limit: Int!, $skip: Int!) {\n    pinned: threads(where: {board: $board, isPinned: true}, orderBy: lastBumpedAt, orderDirection: $orderDirection, block: {number: $block}) {\n      ...Thread\n      replies(first: 3, orderBy: n, orderDirection: $orderDirection) {\n        ...Post\n      }\n    }\n    threads(where: {board: $board, isPinned: false}, orderBy: $orderBy, orderDirection: $orderDirection, first: $limit, skip: $skip, block: {number: $block}) {\n      ...Thread\n      replies(first: 3, orderBy: n, orderDirection: $orderDirection) {\n        ...Post\n      }\n    }\n  }\n"])),nt,tt),Xt=Object(N.a)(Jt||(Jt=Object(y.a)(["\n  ","\n  \n  query BoardGet($board: String!, $block: Int!) {\n    boardRef(id: $board, block: {number: $block}) {\n      board {\n        ...Board\n      }\n    }\n    board(id: $board, block: {number: $block}) {\n      ...Board\n    }\n  }\n"])),qt);function Zt(e,t){var n=e.score;return parseInt(n)/1e9<parseInt("".concat(t||1))}var Kt=n(423);function $t(e){var t=e.label,n=e.to,c=Object(d.g)().search;return Object(I.jsxs)("div",{children:["[",Object(I.jsx)(Kt.a,{className:"dchan-link",to:"".concat(c).concat(n),children:t}),"]"]})}function en(e){var t=e.status,n=e.className,c=void 0===n?"":n;return t?Object(I.jsx)("div",{className:c+" inline-block text-xs",children:Object(I.jsx)("div",{className:"bg-secondary px-1 border border-black",children:t.error?Object(I.jsx)("div",{className:"text-red-600",children:Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:"Error"}),Object(I.jsx)("pre",{className:"whitespace-pre-wrap",children:t.error.message?t.error.message:JSON.stringify(t.error,null,2)})]})}):t.progress?Object(I.jsxs)("div",{className:"text-gray-900 flex center",children:[Object(I.jsx)(rt,{size:4,speed:"faster"}),Object(I.jsx)("span",{className:"px-2",children:t.progress})]}):t.success?Object(I.jsx)("div",{className:"text-green-600",children:Object(I.jsx)("span",{className:"px-2",children:t.success})}):Object(ke.isString)(t)?t:"{}"===JSON.stringify(t)?"No tx result returned by wallet, but it likely went through successfully.":JSON.stringify(t)})}):Object(I.jsx)("span",{})}function tn(e){var t=e.children,n=t?t.map?t:[t]:[];return Object(I.jsxs)("details",{className:"dchan-menu z-20 text-sm inline text-left opacity-10 hover:opacity-100",children:[Object(I.jsx)("summary",{className:"top-0 px-1 h-4 relative"}),Object(I.jsx)("div",{className:"bg-secondary border border-solid border-black p-1 w-32 absolute z-50 pl-3",children:n.map((function(e){return e}))})]})}function nn(e){var t=e.block,n=e.dateTime,a=e.board,r=e.thread,s=e.baseUrl,o=e.search,d=Fe().accounts,b=ze().isJannyOf,j=!!a&&b(a.id),u=Object(c.useState)(),h=Object(i.a)(u,2),p=h[0],m=h[1];return Object(I.jsxs)("header",{id:"board-header",children:[Object(I.jsx)(dt,{block:t,dateTime:n,board:a||void 0,thread:r,baseUrl:s,search:o}),Object(I.jsx)(bt,{}),Object(I.jsxs)("div",{className:"text-4xl text-contrast font-weight-800 font-family-tahoma relative",children:[Object(I.jsx)("div",{className:"text-xs pb-2",children:Object(I.jsx)(je,{id:(null===a||void 0===a?void 0:a.id)||"0x0000000000000000000000000000000000000000"})}),Object(I.jsxs)("div",{children:[Object(I.jsx)("span",{children:(null===a||void 0===a?void 0:a.isLocked)?Object(I.jsx)("span",{title:"Board locked. You cannot reply anymore.",children:"\ud83d\udd12"}):Object(I.jsx)("span",{})})," ",Object(I.jsx)("span",{className:"font-semibold",children:null===a?Object(I.jsx)("div",{children:"/?/ - ?????"}):Object(I.jsxs)(l.b,{to:a?"/".concat(a.name,"/").concat(a.id).concat(o||"").concat(t?"?block=".concat(t):""):"#",children:["/",(null===a||void 0===a?void 0:a.name)||"?","/ - ",(null===a||void 0===a?void 0:a.title)||"..."]})}),a&&j?Object(I.jsxs)("span",{children:[Object(I.jsx)("span",{children:Object(I.jsxs)(tn,{children:[Object(I.jsx)("div",{children:a.isLocked?Object(I.jsxs)("span",{children:[Object(I.jsx)("input",{name:"lock",type:"hidden",value:"false"}),Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return Bt.apply(this,arguments)}(null===a||void 0===a?void 0:a.id,d,m)},children:"\ud83d\udd13 Unlock"})]}):Object(I.jsxs)("span",{children:[Object(I.jsx)("input",{name:"lock",type:"hidden",value:"true"}),Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return Ct.apply(this,arguments)}(a.id,d,m)},children:"\ud83d\udd12 Lock"})]})}),Object(I.jsx)("div",{children:Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return Nt.apply(this,arguments)}(a.id,d,m)},children:"\u274c Remove"})})]})}),Object(I.jsx)(en,{className:"p-4",status:p})]}):""]})]}),Object(I.jsx)("div",{className:"p-2",children:Object(I.jsx)("hr",{})})]})}var cn=n(426);function an(e){var t=e.value,n=e.className,c=void 0===n?"":n,a=e.maxLength;return Object(I.jsx)("span",{className:["absolute bottom-0 right-0 text-xs bg-white pointer-events-none",c,t<.1*a?"opacity-0":t<.5*a?"opacity-25":t<.9*a?"opacity-50":t<a?"opacity-75":"opacity-100 text-contrast"].join(" "),children:"".concat(t,"/").concat(a)})}function rn(){return Object(I.jsx)("div",{className:"text-xs text-gray-400 hover:text-gray-600 pt-1",children:Object(I.jsx)("small",{children:"Using dchan is free. Est. base tx gas price: 0.0001 MATIC (~$0.0001)"})})}function sn(e){var t=e.user,n=e.className,c=void 0===n?"":n;return Object(I.jsx)("a",{className:"dchan-link",href:"https://polygonscan.com/address/".concat(t.address),target:"_blank",children:Object(I.jsx)(je,{id:t.address||"0x000000",className:c,children:t.b58id})})}function on(){var e,t=Fe(),n=t.provider,a=t.accounts,r=t.chainId,s=null===(e=ze().data)||void 0===e?void 0:e.user,o=a[0],l=Object(c.useState)(),d=Object(i.a)(l,2),b=d[0],j=d[1];return Object(c.useEffect)((function(){var e=function(){var e=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,!o){e.next=13;break}return e.t0=j,e.t1=parseInt,e.next=6,le(o);case 6:e.t2=e.sent,e.t3=(0,e.t1)(e.t2),e.t4=Math.pow(10,18),e.t5=e.t3/e.t4,(0,e.t0)(e.t5),e.next=14;break;case 13:j(void 0);case 14:e.next=19;break;case 16:e.prev=16,e.t6=e.catch(0),console.error({refreshBalance:e.t6});case 19:case"end":return e.stop()}}),e,null,[[0,16]])})));return function(){return e.apply(this,arguments)}}(),t=setInterval(e,1e4);return e(),function(){return clearInterval(t)}}),[o]),n&&o&&s&&be(r)?Object(I.jsxs)("div",{className:"text-xs center grid",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("span",{className:"px-1",children:"Connected as"}),Object(I.jsxs)("span",{children:["[",Object(I.jsx)(sn,{user:s}),"]"]},o)]}),Object(I.jsx)("div",{children:void 0!==b?Object(I.jsxs)("span",{children:["( ",b.toFixed(4),Object(I.jsx)("img",{className:"inline h-4 w-4 mx-1",alt:"MATIC",src:O}),")",void 0!==b&&b<.001?Object(I.jsxs)("div",{className:"p-4",children:[Object(I.jsx)("div",{children:"Need Matic?"}),Object(I.jsxs)("div",{children:["Free faucets:",Object(I.jsx)(T,{})]})]}):""]}):""})]}):Object(I.jsx)("span",{})}var ln="0x".concat(137..toString(16)),dn={chainId:ln,chainName:"Polygon (Matic) Mainnet",rpcUrls:["https://polygon-rpc.com","https://rpc-mainnet.matic.network","https://matic-mainnet.chainstacklabs.com","https://rpc-mainnet.maticvigil.com","https://rpc-mainnet.matic.quiknode.pro","https://matic-mainnet-full-rpc.bwarelabs.com","https://matic-mainnet-archive-rpc.bwarelabs.com"],iconUrls:["https://raw.githubusercontent.com/trustwallet/assets/master/blockchains/ethereum/assets/0x7D1AfA7B718fb893dB30A3aBc0Cfc608AaCfeBB0/logo.png"],blockExplorerUrls:["https://polygonscan.com/"],nativeCurrency:{name:"Matic Token",symbol:"MATIC",decimals:18}},bn=[-32603,4902];function jn(){return un.apply(this,arguments)}function un(){return(un=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,window.ethereum.request({method:"wallet_switchEthereumChain",params:[{chainId:ln}]});case 3:e.next=12;break;case 5:if(e.prev=5,e.t0=e.catch(0),!bn.includes(e.t0.code)){e.next=11;break}hn(),e.next=12;break;case 11:throw e.t0;case 12:case"end":return e.stop()}}),e,null,[[0,5]])})))).apply(this,arguments)}function hn(){return pn.apply(this,arguments)}function pn(){return(pn=Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,window.ethereum.request({method:"wallet_addEthereumChain",params:[dn]});case 2:window.location.reload();case 3:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function mn(){var e=Fe(),t=e.provider,n=e.chainId,a=Object(c.useState)(!1),r=Object(i.a)(a,2),s=r[0],o=r[1],l=Object(c.useCallback)(Object(x.a)(m.a.mark((function e(){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o(!0),e.next=3,jn();case 3:o(!1);case 4:case"end":return e.stop()}}),e)}))),[]);return t&&!be(n)?Object(I.jsxs)("div",{className:"p-4",children:[Object(I.jsxs)("div",{children:["You need to be connected to the ",Object(I.jsx)("img",{className:"inline h-4 w-4 ml-1",alt:"MATIC",src:O})," Polygon chain in order to interact with dchan."]}),Object(I.jsxs)("div",{children:["[",Object(I.jsx)("button",{className:"dchan-link",onClick:l,children:"Switch chain"}),"]"]}),Object(I.jsx)("div",{className:"text-xs",children:"Polygon chain ID: 0x89"}),Object(I.jsxs)("div",{className:"text-xs",children:["Current chain ID: ",n]}),s?Object(I.jsx)(ut,{ms:3e3,children:Object(I.jsxs)("div",{className:"text-xs px-2",children:["If the button doesn't work, try switching the network from your wallet.",Object(I.jsx)(ut,{ms:6e3,children:Object(I.jsxs)("div",{children:["If you can't find the correct chain in your wallet, try manually adding it using "," ",Object(I.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://www.google.com/search?q=how+to+add+polygon+chain",className:"dchan-link",children:"this guide"}),"."]})})]})}):""]}):Object(I.jsx)("span",{})}function xn(){return Object(I.jsxs)("span",{children:[Object(I.jsx)(ht,{}),Object(I.jsx)(on,{}),Object(I.jsx)(mn,{}),Object(I.jsx)(rn,{})]})}var On=["ref"];function fn(e){var t=e.baseUrl,n=e.thread,a=e.board,r=Fe(),s=r.provider,l=r.chainId,b=r.accounts,j=Object(d.f)(),u=Object(c.useRef)(null),h=Object(c.useState)(!1),p=Object(i.a)(h,2),O=p[0],f=p[1],v=Object(c.useState)(Object(ke.uniqueId)()),g=Object(i.a)(v,2),A=g[0],k=g[1],w=Object(c.useState)(),y=Object(i.a)(w,2),N=y[0],C=y[1],B=Object(c.useState)(0),S=Object(i.a)(B,2),E=S[0],T=S[1],D=Object(c.useState)(0),_=Object(i.a)(D,2),P=_[0],H=_[1],L=Object(c.useState)(0),M=Object(i.a)(L,2),R=M[0],F=M[1],z=Object(c.useState)(0),W=Object(i.a)(z,2),U=W[0],Y=W[1],V=Object(c.useState)(),J=Object(i.a)(V,2),G=J[0],X=J[1],Z=_e(),K=Z.subscribe,$=Z.unsubscribe,ee=Ie().addFavorite,te=Object(_t.a)(),ae=te.register,re=te.handleSubmit,se=te.formState.errors,ie=te.setValue,oe=te.getValues,le=te.reset,de=te.trigger,be=te.setFocus,ue=te.watch;Object(c.useLayoutEffect)((function(){return function(){de()}}),[de]);var he=oe().file,pe=!!s&&("0x89"===l||137===l),me=Object(c.useState)(!1),xe=Object(i.a)(me,2),Oe=xe[0],fe=xe[1],ve=Object(c.useRef)(null),ge=ae("comment",{required:!n}),Ae=ge.ref,we=Object(cn.a)(ge,On),ye=Object(c.useMemo)((function(){return(null===n||void 0===n?void 0:n.id)||(null===a||void 0===a?void 0:a.id)||"form"}),[n,a]),Ne=Se(ye,{watch:ue,setValue:ie},{include:["name","comment","subject"]}).clear,Ce=Object(c.useCallback)((function(e,t){var n=t.from,c=t.n,a=oe().comment,r=">>0x".concat(ce(n).replace("-",""),"/").concat(c),s=ve.current,i="",o=0;if(s)if(s.selectionStart||0===s.selectionStart){var l=s.selectionStart,d=s.selectionEnd;o=l,i=a.substr(0,l),l>0&&a.substr(l-1,1).match(/\w/)&&(i+=" ",o+=1),i+=r+"\n"+a.substr(d),o+=r.length+1}else o=(i=a+r+"\n").length;ie("comment",i),s&&(s.selectionStart=o,s.selectionEnd=o);try{var b;null===u||void 0===u||null===(b=u.current)||void 0===b||b.scrollIntoView(),pe&&be("comment")}catch(j){console.error({e:j})}}),[oe,ie,u,be,pe]);Object(c.useEffect)((function(){var e=K("FORM_QUOTE",Ce);return function(){$(e)}})),Object(c.useEffect)((function(){fe(O)}),[O,fe]);var Be=Object(c.useCallback)((function(){k(Object(ke.uniqueId)())}),[k]),Ee=Object(c.useCallback)((function(){window.confirm("Reset form?")&&(le(),de(),Be(),Ne())}),[le,de,Be,Ne]),Te=Object(c.useCallback)(function(){var e=Object(x.a)(m.a.mark((function e(t){var c,a,r,s,i,o,l;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n&&ee&&ee(n),f(!0),r=null,e.prev=3,e.next=6,vt(t,b,C,ne.ipfs.endpoint);case 6:r=e.sent,e.next=15;break;case 9:e.prev=9,e.t0=e.catch(3),(r={error:e.t0}).error.message.match(/failed.*check.*transaction.*receipt/i)&&(delete r.error,r.success=!0),C(r),console.log({result:r});case 15:f(!1),r&&!r.error&&Ee(),(s=null===(c=r)||void 0===c||null===(a=c.events)||void 0===a?void 0:a.Message)&&(i=s.transactionHash,o=s.logIndex,l="/".concat(i,"-").concat(o),j.push(l));case 19:case"end":return e.stop()}}),e,null,[[3,9]])})));return function(t){return e.apply(this,arguments)}}(),[b,j,C,f,Ee,ee,n]),De=Object(c.useCallback)(Object(x.a)(m.a.mark((function e(){var t,n,c;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:(t=oe().file)&&t.length>0?(n=t[0],(c=new FileReader).readAsDataURL(n),c.onload=function(){var e=c.result;X(e)}):X(void 0);case 2:case"end":return e.stop()}}),e)}))),[oe,X]),Pe=Object(c.useCallback)(Object(x.a)(m.a.mark((function e(){var t;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:De(),(t=oe().file)&&t.length>0?F(t[0].size/1024):F(0);case 3:case"end":return e.stop()}}),e)}))),[De,F,oe]),He=Object(c.useCallback)((function(){ie("file",void 0),Pe()}),[ie,Pe]),Le=Object(c.useCallback)((function(){var e=oe().file;if(e&&e.length>0){var t=e[0],n=prompt("Rename in",t.name);if(n){if(n.length>1e3)return void alert("Filename too long, 1000 chars max");var c=t.slice(0,t.size,t.type),a=new DataTransfer;a.items.add(new File([c],n,{type:t.type})),ie("file",a.files)}}}),[oe,ie]),Me=Object(c.useCallback)((function(e){var t=e.clipboardData||e.originalEvent.clipboardData,n=t.files,c=t.items;if(c&&c.length>0){var a=c[0];if("file"===a.kind){var r=a.getAsFile(),s=new FileReader;s.onload=function(){var e=Object(x.a)(m.a.mark((function e(t){var n,c,a,r,s;return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(c=null===t||void 0===t||null===(n=t.target)||void 0===n?void 0:n.result,!Object(ke.isString)(c)){e.next=10;break}return a=c.substring(c.indexOf(":")+1,c.indexOf(";")),e.next=5,fetch(c).then((function(e){return e.arrayBuffer()})).then((function(e){return new File([e],"file.".concat(a.split("/")[1]),{type:a})}));case 5:r=e.sent,(s=new DataTransfer).items.add(r),ie("file",s.files),Pe();case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),s.readAsDataURL(r)}}else n&&n.length>0&&(ie("file",n),Pe())}),[Pe,ie]),Qe=Object(c.useState)(t),Re=Object(i.a)(Qe,2),qe=Re[0],We=Re[1];Object(c.useEffect)((function(){t&&t!==qe&&(We(t),Ee())}),[t,qe,We,Ee]),function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:window,a=Object(c.useRef)();Object(c.useEffect)((function(){a.current=t}),[t]),Object(c.useEffect)((function(){if(n&&n.addEventListener){var t=function(e){return a?a.current(e):""};return n.addEventListener(e,t),function(){n.removeEventListener(e,t)}}}),[e,n])}("paste",Me);var Ue=ze().isJannyOf,Ye=!!a&&Ue(a.id),Ve=Object(c.useCallback)((function(){Be()}),[Be]),Je=function(){return Object(I.jsxs)("span",{children:[Object(I.jsx)("span",{className:"text-xs",children:Object(I.jsx)("button",{onClick:Ee,children:"\u274c"})}),Object(I.jsxs)(tn,{children:[Object(I.jsx)("div",{children:"Options:"}),Object(I.jsxs)("div",{className:"flex",children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({id:"dchan-input-sage",className:"mx-1",type:"checkbox"},ae("sage")),{},{disabled:Oe})),Object(I.jsx)("label",{htmlFor:"dchan-input-sage",className:"text-black font-weight-800 font-family-tahoma",children:Object(I.jsx)("div",{title:"Does not bump the thread",children:"sage"})})]})]})]})};return Object(I.jsxs)("div",{className:"z-30",children:[Object(I.jsx)(xn,{}),!Ye&&(null===n||void 0===n?void 0:n.isLocked)?Object(I.jsxs)("div",{className:"text-contrast font-weight-800 font-family-tahoma",children:[Object(I.jsx)("div",{children:"Thread locked."}),Object(I.jsx)("div",{children:"You cannot reply."})]}):!Ye&&(null===a||void 0===a?void 0:a.isLocked)?Object(I.jsxs)("div",{className:"text-contrast font-weight-800 font-family-tahoma",children:[Object(I.jsx)("div",{children:"Board locked."}),Object(I.jsx)("div",{children:"You cannot post."})]}):n||a?Object(I.jsx)("div",{children:pe?Object(I.jsx)("div",{className:"grid center w-full text-left sticky top-0 min-h-200px",children:Object(I.jsxs)("form",{ref:u,id:"dchan-post-form",className:"grid center bg-primary p-2 pointer-events-auto bg-primary",onSubmit:re(Te),onBlur:Ve,children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({type:"hidden"},ae("nonce")),{},{disabled:Oe,value:A})),a?Object(I.jsx)("input",Object(o.a)(Object(o.a)({type:"hidden"},ae("board")),{},{disabled:Oe,value:a.id})):"",n?Object(I.jsx)("input",Object(o.a)(Object(o.a)({type:"hidden"},ae("thread")),{},{disabled:Oe,value:n.id})):"",Object(I.jsx)("table",{children:Object(I.jsxs)("tbody",{children:[n?Object(I.jsx)("tr",{}):Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{className:"px-2 border border-solid border-black bg-highlight font-semibold text-sm",children:"Name"}),Object(I.jsx)("td",{children:Object(I.jsxs)("span",{className:"relative",children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({className:"dchan-input-name px-1 border border-solid border-gray focus:border-indigo-300",type:"text",placeholder:"Anonymous"},ae("name")),{},{disabled:Oe,onChange:function(e){return H(e.target.value.length)},maxLength:70})),Object(I.jsx)(an,{maxLength:70,value:P})]})})]}),n?Object(I.jsx)("tr",{}):Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{className:"px-2 border border-solid border-black bg-highlight font-semibold text-sm",children:"Subject"}),Object(I.jsx)("td",{children:Object(I.jsxs)("div",{className:"flex items-center justify-start",children:[Object(I.jsxs)("span",{className:"relative",children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({className:"dchan-input-subject px-1 border border-solid border-gray focus:border-indigo-300",type:"text"},ae("subject")),{},{disabled:Oe,onChange:function(e){return Y(e.target.value.length)},maxLength:140,placeholder:"..."})),Object(I.jsx)(an,{maxLength:140,value:U})]}),Object(I.jsx)("button",{className:"dchan-post-submit px-2 mx-1 bg-gray-100 border",type:"submit",disabled:O,children:"New thread"}),N?"":Je(),Object(I.jsx)(en,{status:N})]})})]}),n?Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{className:"px-2 border border-solid border-black bg-highlight font-semibold text-sm",children:"Name"}),Object(I.jsx)("td",{children:Object(I.jsxs)("div",{className:"flex items-center justify-start",children:[Object(I.jsxs)("span",{className:"relative",children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({className:"dchan-input-name px-1 border border-solid border-gray focus:border-indigo-300",type:"text",placeholder:"Anonymous"},ae("name")),{},{disabled:Oe,onChange:function(e){return H(e.target.value.length)},maxLength:70})),Object(I.jsx)(an,{maxLength:70,value:P})]}),Object(I.jsx)("button",{className:"dchan-post-submit px-2 mx-1 bg-gray-100 border",type:"submit",disabled:Oe,children:"Post Reply"}),N?"":Je(),Object(I.jsx)(en,{status:N})]})})]}):Object(I.jsx)("tr",{}),Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{className:"px-2 border border-solid border-black bg-highlight font-semibold text-sm",children:"Comment"}),Object(I.jsxs)("td",{children:[Object(I.jsxs)("span",{className:"relative",children:[Object(I.jsx)("textarea",Object(o.a)(Object(o.a)({className:"dchan-input-comment px-1 font-sans border border-solid border-gray focus:border-indigo-300",cols:40,rows:4},we),{},{ref:function(e){Ae(e),ve.current=e},disabled:Oe,onChange:function(e){return T(e.target.value.length)},maxLength:2e3,placeholder:"..."})),Object(I.jsx)(an,{className:"pr-4",maxLength:2e3,value:E})]}),se.comment&&Object(I.jsx)("div",{className:"px-1 text-contrast",children:"This field is required"})]})]}),Object(I.jsxs)("tr",{children:[Object(I.jsx)("td",{className:"px-2 border border-solid border-black bg-highlight font-semibold text-sm",children:"File"}),Object(I.jsx)("td",{className:"flex text-xs",children:Object(I.jsxs)("div",{className:"flex-grow mx-0.5",children:[Object(I.jsx)("span",{className:"text-xs float-right bg-primary",children:"(1000kb max)"}),Object(I.jsx)("input",Object(o.a)(Object(o.a)({className:"w-64",type:"file",accept:"image/*"},ae("file",{required:!1})),{},{disabled:Oe,onChange:Pe})),Object(I.jsxs)("div",{className:"flex",children:[G?Object(I.jsxs)("details",{className:"mx-0.5",open:!0,children:[Object(I.jsx)("summary",{children:"\ud83d\uddbc"}),Object(I.jsx)("img",{alt:"",className:"max-h-24 max-w-16rem",src:G}),Object(I.jsxs)("span",{className:"text-xs ".concat(R>1e3?"text-contrast":""),children:[Math.round(R)," kb"]})]}):"",he&&he.length>0?Object(I.jsxs)("div",{className:"flex",children:[Object(I.jsxs)("span",{children:[Object(I.jsx)("button",{className:"dchan-input-file-rename mx-0.5",title:"Rename file",type:"button",onClick:Le,children:"\u270e"}),Object(I.jsx)("button",{className:"dchan-input-file-remove mx-0.5",title:"Remove file",type:"button",onClick:He,children:"\u274c"})]}),Object(I.jsxs)("details",{className:"mx-0.5",children:[Object(I.jsx)("summary",{className:"marker-closed-hide",children:"\u2699\ufe0f"}),Object(I.jsxs)("div",{children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({id:"dchan-input-is_spoiler",className:"mx-1",type:"checkbox"},ae("is_spoiler")),{},{disabled:Oe})),Object(I.jsx)("label",{htmlFor:"dchan-input-is_spoiler",className:"text-black font-weight-800 font-family-tahoma",children:"Spoiler"})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({id:"dchan-input-is_nsfw",className:"mx-1",type:"checkbox"},ae("is_nsfw")),{},{disabled:Oe})),Object(I.jsx)("label",{htmlFor:"dchan-input-is_nsfw",className:"text-black font-weight-800 font-family-tahoma",children:"NSFW"})]})]})]}):""]})]})}),se.file&&Object(I.jsx)("div",{className:"px-1 text-contrast",children:"This field is required"})]})]})}),Object(I.jsxs)("div",{className:"text-xs grid center",children:[Object(I.jsxs)("div",{className:"p-1 flex center",children:[Object(I.jsx)("input",Object(o.a)(Object(o.a)({id:"dchan-input-rules",className:"mx-1",type:"checkbox"},ae("rulesAccepted",{required:!0})),{},{disabled:Oe})),Object(I.jsx)("label",{htmlFor:"dchan-input-rules",className:"text-black font-weight-800 font-family-tahoma",children:Object(I.jsxs)("ul",{children:[Object(I.jsxs)("li",{children:["I've read the"," ",Object(I.jsx)(q,{})," ","and the"," ",Object(I.jsx)(Q,{})," ","before posting."]}),Object(I.jsxs)("li",{children:["I understand that"," ",Object(I.jsx)("abbr",{title:"Other users will be able to view all past transactions you ever made using this address. Be mindful of the security risks this entails.",children:Object(I.jsx)("i",{children:"my posts will be publicly signed by my address"})})]}),Object(I.jsx)("li",{children:Object(I.jsxs)("i",{children:[b&&b.length>0?Object(I.jsx)("a",{href:"https://polygonscan.com/address/".concat(b[0]),target:"_blank",children:Object(I.jsx)(je,{id:b[0],children:b[0]})}):""," "]})}),Object(I.jsxs)("li",{children:["and that"," ",Object(I.jsx)("abbr",{title:"Posts are stored on the blockchain and images are uploaded to IPFS. _This_cannot_be_undone_. Content can be removed, but can still be obtained.",children:Object(I.jsx)("i",{children:"I won't be able to delete the content I post."})})]})]})})]}),se.rulesAccepted&&Object(I.jsx)("div",{className:"px-1 text-contrast",children:"This field is required"})]})]})}):""}):Object(I.jsx)(st,{})]})}var vn=n(894);function gn(e){var t,n,a=e.onRefresh,r=Be(),s=Object(i.a)(r,2),l=s[0],d=s[1],b=Object(c.useState)(""),j=Object(i.a)(b,2),u=j[0],h=j[1],p=Object(c.useState)(g.DateTime.now()),m=Object(i.a)(p,2),x=m[0],O=m[1],f=Object(c.useCallback)((function(){O(g.DateTime.now()),a()}),[O,a]),v=Object(c.useCallback)((function(){var e,t,n=-x.diffNow().toMillis()/1e3;if((null===l||void 0===l||null===(e=l.autorefresh)||void 0===e?void 0:e.enabled)&&n>((null===l||void 0===l||null===(t=l.autorefresh)||void 0===t?void 0:t.seconds)||Number.MAX_SAFE_INTEGER))f();else{if(0===n)return;h(x.toRelative()||"")}}),[l,x,h,f]);return Object(c.useEffect)((function(){v()}),[x,v]),Object(vn.a)((function(){v()}),1e3),Object(I.jsx)("span",{className:"mx-4 flex items-start relative whitespace-nowrap",children:Object(I.jsx)("div",{children:Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:Object(I.jsxs)("span",{children:["[",Object(I.jsx)("button",{className:"dchan-link",onClick:f,children:u||"Refreshing..."}),"]"]})}),Object(I.jsxs)("div",{className:"bg-secondary p-2",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"dchan-input-refresh-toggle",children:"Enable autorefresh"}),Object(I.jsx)("input",{id:"dchan-input-refresh-toggle",className:"mx-1 text-xs whitespace-nowrap",type:"checkbox",checked:null===l||void 0===l||null===(t=l.autorefresh)||void 0===t?void 0:t.enabled,onChange:function(e){d(Object(o.a)(Object(o.a)({},l),{},{autorefresh:Object(o.a)(Object(o.a)({},null===l||void 0===l?void 0:l.autorefresh),{},{enabled:e.target.checked})}))}})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{htmlFor:"dchan-input-autorefresh-interval",children:"Autorefresh interval (seconds)"}),Object(I.jsx)("input",{id:"dchan-input-autorefresh-interval",className:"mx-1 text-xs whitespace-nowrap",type:"number",min:"10",value:null===l||void 0===l||null===(n=l.autorefresh)||void 0===n?void 0:n.seconds,onChange:function(e){d(Object(o.a)(Object(o.a)({},l),{},{autorefresh:Object(o.a)(Object(o.a)({},null===l||void 0===l?void 0:l.autorefresh),{},{seconds:e.target.value})}))}})]})]})]})})})}function An(){var e,t,n,c,a=Be(),r=Object(i.a)(a,2),s=r[0],l=r[1];return Object(I.jsxs)("details",{children:[Object(I.jsx)("summary",{children:Object(I.jsxs)("span",{children:[Object(I.jsxs)("span",{className:"whitespace-nowrap",children:[Object(I.jsx)("label",{className:"pl-2",htmlFor:"dchan-input-view-mode",children:"Sort by"}),Object(I.jsxs)("select",{id:"dchan-input-view-mode",onChange:function(e){l(Object(o.a)(Object(o.a)({},s),{},{content_view:Object(o.a)(Object(o.a)({},null===s||void 0===s?void 0:s.content_view),{},{board_sort_threads_by:e.target.value})}))},value:null===s||void 0===s||null===(e=s.content_view)||void 0===e?void 0:e.board_sort_threads_by,children:[Object(I.jsx)("option",{value:"lastBumpedAt",children:"Last bumped at"}),Object(I.jsx)("option",{value:"replyCount",children:"Reply count"}),Object(I.jsx)("option",{value:"imageCount",children:"File count"})]})]}),Object(I.jsxs)("span",{className:"whitespace-nowrap",children:[Object(I.jsx)("label",{className:"pl-2",htmlFor:"dchan-input-view-mode",children:"Sort direction"}),Object(I.jsxs)("select",{id:"dchan-input-view-mode",onChange:function(e){l(Object(o.a)(Object(o.a)({},s),{},{content_view:Object(o.a)(Object(o.a)({},null===s||void 0===s?void 0:s.content_view),{},{board_sort_direction:e.target.value})}))},value:null===s||void 0===s||null===(t=s.content_view)||void 0===t?void 0:t.board_sort_direction,children:[Object(I.jsx)("option",{value:"asc",children:"Ascending"}),Object(I.jsx)("option",{value:"desc",children:"Descending"})]})]})]})}),Object(I.jsxs)("div",{className:"bg-secondary p-2",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{className:"px-2",htmlFor:"dchan-input-view-mode",children:"Page size"}),Object(I.jsx)("input",{id:"dchan-input-page-size",type:"number",min:1,value:null===s||void 0===s||null===(n=s.content_view)||void 0===n?void 0:n.page_size,onChange:function(e){l(Object(o.a)(Object(o.a)({},s),{},{content_view:Object(o.a)(Object(o.a)({},null===s||void 0===s?void 0:s.content_view),{},{page_size:e.target.value})}))}})]}),Object(I.jsxs)("div",{children:[Object(I.jsx)("label",{className:"px-2",htmlFor:"dchan-input-view-mode",children:"Default board view mode"}),Object(I.jsxs)("select",{id:"dchan-input-view-mode",onChange:function(e){l(Object(o.a)(Object(o.a)({},s),{},{content_view:Object(o.a)(Object(o.a)({},null===s||void 0===s?void 0:s.content_view),{},{board_default_view_mode:e.target.value})}))},value:null===s||void 0===s||null===(c=s.content_view)||void 0===c?void 0:c.board_default_view_mode,children:[Object(I.jsx)("option",{value:"catalog",children:"Catalog"}),Object(I.jsx)("option",{value:"index",children:"Index"})]})]})]})]})}function kn(e){var t=e.board,n=e.thread,c=e.search,a=e.baseUrl,r=e.block,s=e.dateTime,i=e.summary,o=e.onRefresh,d=Te().lastBlock,b=Object(et.a)(o,1,!0),j={};r&&(j.block="".concat(r)),null!=s&&(j.date=s.toISODate());var u=j?"?".concat(Object.entries(j).map((function(e){return e[0]+"="+e[1]})).join("&")):"";return Object(I.jsxs)("div",{children:[Object(I.jsx)(nn,{block:r,dateTime:s,board:t,thread:n,baseUrl:a,search:c}),null===t?"":n||t?Object(I.jsx)(fn,{baseUrl:a,thread:n,board:t}):Object(I.jsx)(st,{}),Object(I.jsx)("div",{className:"p-2",children:Object(I.jsx)("hr",{})}),Object(I.jsxs)("div",{className:"text-center sm:text-left grid xl:grid-cols-3 text-xs",children:[Object(I.jsxs)("div",{className:"mx-2 flex flex-wrap sm:flex-nowrap justify-center md:justify-start items-center",children:[Object(I.jsxs)("span",{className:"whitespace-nowrap sm:flex",children:[t?Object(I.jsxs)("span",{children:[Object(I.jsxs)("span",{children:["[",Object(I.jsx)(l.b,{className:"dchan-link",to:"".concat(K.board(t),"/index").concat(u),children:"Index"}),"]"]}),Object(I.jsxs)("span",{children:["[",Object(I.jsx)(l.b,{className:"dchan-link",to:"".concat(K.board(t),"/catalog").concat(u),children:"Catalog"}),"]"]})]}):"",Object(I.jsx)($t,{to:"#bottom",label:"Bottom"})]}),!r||d&&"".concat(d.number)===r?Object(I.jsx)(gn,{onRefresh:b}):""]}),Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)("span",{className:"py-2 text-xs text-gray-600",children:i})}),Object(I.jsx)("div",{className:"flex flex-wrap justify-center md:justify-end items-center pr-2",children:n?"":Object(I.jsx)(An,{})})]}),Object(I.jsx)("div",{className:"p-2",children:Object(I.jsx)("hr",{})})]})}var wn=n.p+"static/media/spoiler.6b76e9d2.png",yn=n.p+"static/media/ipfs.c10ee176.png",Nn=n.p+"static/media/ipfs_error.1c48d4ab.png";function Cn(e){var t=e.hash,n=e.style,a=e.htmlLoading,r=void 0===a?"lazy":a,s=e.className,l=void 0===s?"":s,d=e.isSpoiler,b=void 0!==d&&d,j=e.isNsfw,u=void 0!==j&&j,h=e.expandable,p=void 0!==h&&h,m=e.thumbnail,x=void 0!==m&&m,O=e.thumbnailClass,f=void 0===O?"max-w-8rem max-h-32":O,v="https://ipfs.io/ipfs/".concat(t),g=Object(c.useState)(!1),A=Object(i.a)(g,2),k=A[0],w=A[1],y=Object(c.useState)(!0),N=Object(i.a)(y,2),C=N[0],B=N[1],S=Object(c.useState)(v),E=Object(i.a)(S,2),T=E[0],D=E[1],_=Object(c.useState)(!1),P=Object(i.a)(_,2),H=P[0],L=P[1],M=Object(c.useState)(!1),Q=Object(i.a)(M,2),R=Q[0],F=Q[1],z=Object(c.useState)(!x),q=Object(i.a)(z,2),W=q[0],U=q[1];f=x?f:"";var Y=(!u||R)&&(!b||H),V=Object(c.useCallback)((function(){B(!0),D("".concat(v,"?t=").concat((new Date).getTime())),w(void 0)}),[v,B,D,w]);return Object(I.jsxs)("span",{children:[Object(I.jsx)("img",{className:"".concat(l," ").concat(!W||k?f:""," animation-fade-in"),style:C?Object(o.a)(Object(o.a)({},n),{},{visibility:"hidden",position:"absolute"}):k||!Y?{display:"none"}:n,src:T,onLoad:function(){return B(!1)},loading:r,onClick:function(){p&&U(!W)},onError:function(e){B(!1),w(e)},alt:""}),Object(I.jsx)("div",{className:"".concat(l," relative"),children:Object(I.jsx)("span",{children:Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"opacity-50",children:C?Object(I.jsxs)("div",{className:"relative center grid",children:[Object(I.jsx)("img",{className:"h-150px w-150px animation-download",style:n,src:yn,onClick:V,alt:""}),Object(I.jsx)("div",{className:"p-2",children:"Loading..."})]}):k?Object(I.jsxs)("div",{className:"relative center grid",children:[Object(I.jsx)("img",{className:"h-150px w-150px animation-fade-in",style:n,src:Nn,onClick:V,alt:""}),Object(I.jsx)("div",{className:"p-2",children:"IPFS image load error"})]}):""}),Object(I.jsxs)("div",{children:[C||k||H||!b?"":Object(I.jsx)("img",{className:f,src:wn,alt:"SPOILER",onClick:function(){return L(!0)}}),C||k||!H&&b||R||!u?"":Object(I.jsx)("img",{className:f,src:"data:image/png;base64,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",alt:"NSFW",onClick:function(){return F(!0)}})]})]})})})]})}var Bn=n(255),In=n(45),Sn=Bn.regexp.bind({});function En(e){for(var t=arguments.length,n=new Array(t>1?t-1:0),c=1;c<t;c++)n[c-1]=arguments[c];return In.or.apply(void 0,n)(e)}function Tn(e){var t=[];if(0===e.length)return e;for(var n=e[0],c=1;c<e.length;c++){var a=e[c];"text"===n.type&&"text"===a.type?(n.value+=a.value,n.key+=a.key):(t.push(n),n=e[c])}return t.push(n),t}var Dn=Sn(/.[^[\n>hfQ]*/g).pipe(Object(In.map)((function(e){return{type:"text",key:e[0],value:e[0]}}))),_n=Sn(/(Qm[1-9A-Za-z]{44})/).pipe(Object(In.map)((function(e){return{type:"ipfs",key:e[0],hash:e[0]}}))),Pn=Object(Bn.string)("\n").pipe(Object(In.map)((function(){return{type:"newline",key:""}}))),Hn=Sn(/>>(0[xX][0-9a-fA-F]+)/).pipe(Object(In.map)((function(e){return{type:"ref",key:e[1],id:e[1]}}))),Ln=Sn(/>>(0[xX][0-9a-fA-F]+)\/(\d+)/).pipe(Object(In.map)((function(e){return{type:"postref",key:"".concat(e[1],"/").concat(e[2]),id:e[1],n:e[2]}}))),Mn=En(Sn(/>>(\/[a-zA-Z]+\/)(0[xX][0-9a-fA-F]+(?:\/\d+)?)?/).pipe(Object(In.map)((function(e){return{type:"boardref",key:"".concat(e[1]).concat(e[2]),board:e[1],id:e[2]}}))),Ln,Hn),Qn=Sn(/(\b(https?|ftp|file):\/\/[-A-Z0-9+&@#/%?=~_|!:,.;]*[-A-Z0-9+&@#/%=~_|])/i).pipe(Object(In.map)((function(e){return{type:"link",key:e[0],value:e[0]}}))),Rn=Object(In.later)(),Fn=Rn.pipe(Object(In.many)(),Object(In.between)("[spoiler]","[/spoiler]"),Object(In.map)((function(e){for(var t=Tn(e),n=0;n<t.length;n++)t[n].key+=" ".concat(n);return{type:"spoiler",key:Object(ke.uniqueId)("spoiler_"),value:t}}))),zn=Sn(/[^[][^[\n>hfQ]*/g).pipe(Object(In.map)((function(e){return{type:"text",key:e[0],value:e[0]}})));Rn.init(En(Mn,Fn,Qn,_n,Pn,zn));var qn=En(Fn,Qn,_n,Dn),Wn=Sn(/^>/m).pipe(Object(In.qthen)(En(Mn,qn).pipe(Object(In.many)())),Object(In.thenq)(Sn(/$/m).pipe(Object(In.backtrack)())),Object(In.map)((function(e){for(var t=Tn(e),n=0;n<t.length;n++)t[n].key+=" ".concat(n);return{type:"textquote",key:Object(ke.uniqueId)("textquote_"),value:t}}))),Un=En(Mn,Wn,Pn,qn).pipe(Object(In.many)(),Object(In.map)((function(e){for(var t=Tn(e),n=0;n<t.length;n++)t[n].key+=" ".concat(n);return t})));function Yn(e){var t=e.children,n=e.post,c=e.thread,a=e.block;return Object(I.jsxs)("span",{className:"text-quote",children:[">",t.map((function(e){return Kn(e,n,c,a)}))]})}function Vn(e){var t=e.link,n=e.children;return Object(I.jsxs)(l.b,{className:"dchan-postref dchan-link",to:t,children:[Object(I.jsx)("wbr",{}),Object(I.jsxs)("span",{children:[">>",n]})]})}function Jn(e){var t=e.post,n=e.thread,a=e.value,r=e.block,s=_e().publish,i="".concat(a.id,"/").concat(a.n),o=Object(c.useMemo)((function(){return n&&[n.op].concat(Object(mt.a)(n.replies)).find((function(e){return"".concat(e.from.id,"/").concat(e.n)===i||"0x".concat(ce(e.from.id).replace("-",""),"/").concat(e.n)===i}))}),[n,i]);Object(c.useEffect)((function(){var e={from:t,to:{userId:a.id,n:a.n}};s("POST_BACKLINK",e)}),[t,a,s]);var d=Object(c.useCallback)((function(){null!=o&&s("POST_HIGHLIGHT",o.id)}),[s,o]),b=Object(c.useCallback)((function(){null!=o&&s("POST_DEHIGHLIGHT",o.id)}),[s,o]),j="".concat(t.thread?K.thread(t.thread):t.board?K.board(t.board):"","/"),u=Fe().accounts,h=n&&o&&n.op.id===o.id,p=u&&u[0]&&o&&u[0]===o.from.address,m=n&&!o;return Object(I.jsxs)(l.b,{className:"dchan-postref dchan-link",to:"".concat(m?"/":j).concat(i).concat(r?"?block=".concat(r):""),onMouseEnter:d,onMouseLeave:b,children:[Object(I.jsx)("wbr",{}),Object(I.jsxs)("span",{className:"whitespace-nowrap",children:[">>",i]}),h?" (OP)":"",p?" (You)":"",m?" (Cross-thread)":""]})}function Gn(e){var t=e.children,n=e.post,c=e.thread,a=e.block;return Object(I.jsx)("span",{className:"dchan-post-spoiler",children:t.map((function(e){return Kn(e,n,c,a)}))})}function Xn(e){var t=e.link;return Object(I.jsx)("a",{className:"dchan-link",href:t,target:"_blank",rel:"noreferrer",children:t})}function Zn(e){var t=e.hash;return Object(I.jsxs)("details",{className:"inline w-full",children:[Object(I.jsx)("summary",{children:Object(I.jsx)("a",{className:"dchan-link",href:"//ipfs.io/ipfs/".concat(t),target:"_blank",rel:"noreferrer",children:t})}),Object(I.jsx)("img",{src:"//ipfs.io/ipfs/".concat(t),alt:""})]})}function Kn(e,t,n,c){switch(e.type){case"text":return e.value.trim();case"link":return Object(I.jsx)(Xn,{link:e.value},e.key);case"ipfs":return Object(I.jsx)(Zn,{hash:e.hash},e.key);case"newline":return Object(I.jsx)("br",{},e.key);case"textquote":return Object(I.jsx)(Yn,{post:t,thread:n,block:c,children:e.value},e.key);case"ref":return Object(I.jsx)(Vn,{link:"/".concat(e.id).concat(c?"?block=".concat(c):""),children:e.id},e.key);case"postref":return Object(I.jsx)(Jn,{post:t,thread:n,block:c,value:e},e.key);case"boardref":return Object(I.jsxs)(Vn,{link:"/".concat(e.id).concat(c?"?block=".concat(c):""),children:[e.board,e.id]},e.key);case"spoiler":return Object(I.jsx)(Gn,{post:t,thread:n,block:c,children:e.value},e.key)}}function $n(e){var t=e.post,n=e.thread,a=e.block,r=e.style,s=void 0===r?{}:r,i=e.className,o=void 0===i?"":i,l=Object(c.useMemo)((function(){return""===(e=t.comment)?[]:Un.parse(e).value;var e}),[t.comment]);return Object(I.jsx)("div",{className:o+" block text-left break-words font-sans text-sm max-w-100vw",style:s,children:l.map((function(e){return Kn(e,t,n,a)}))},"".concat(t.id,"-").concat(null===n||void 0===n?void 0:n.id))}var ec=Object(c.memo)($n,ke.isEqual),tc=function(e){var t,n,a=e.thread,r=e.block,s=e.showBoard,o=void 0!==s&&s,l=a.id,b=a.isPinned,j=a.isLocked,u=a.subject,h=a.op,p=a.replyCount,m=a.imageCount,x=a.replies,O=a.board,f=h.image||{ipfsHash:"",isNsfw:!1,isSpoiler:!1},v=f.ipfsHash,A=f.isNsfw,k=f.isSpoiler,w=Be(),y=Object(i.a)(w,1)[0],N=Zt(a,null===y||void 0===y||null===(t=y.content_filter)||void 0===t?void 0:t.score_threshold),C=Object(c.useState)(!1),B=Object(i.a)(C,2),S=B[0],E=B[1],T=Object(d.f)(),D=Object(c.useCallback)((function(){var e=K.thread(a);e&&T.push("".concat(e).concat(r?"?block=".concat(r):""))}),[a,T,r]),_=Object(c.useCallback)((function(){E(!0)}),[E]),P=Object(c.useCallback)((function(){E(!1)}),[E]);return Object(I.jsx)("div",{className:"relative max-w-150px mx-1 w-full",style:{minHeight:"20rem"},children:Object(I.jsxs)("article",{id:l,className:"dchan-post justify-self-center text-decoration-none leading-4 text-black m-0.5 border-black overflow-hidden max-w-150px break-word w-full place-items-center flex",style:S?{maxWidth:"initial",zIndex:40,marginLeft:"-2rem",marginRight:"-2rem",width:"14rem",position:"absolute"}:{minHeight:"20rem",position:"relative"},onMouseEnter:_,onMouseLeave:P,children:[N&&!S?Object(I.jsxs)("button",{onClick:_,className:"absolute text-2xl text-gray-800 top-0 left-0 right-0 bottom-0",children:[Object(I.jsx)("div",{children:"\u26a0\ufe0f"}),Object(I.jsx)("div",{children:"Post hidden due to reports."}),Object(I.jsx)("div",{className:"text-sm text-gray-600",children:"Click to show anyway."})]}):"",Object(I.jsx)("button",{className:"h-full w-full",onClick:D,children:Object(I.jsxs)("div",{className:[S?"relative top-0 z-10 bg-tertiary border border-black h-full":"absolute top-0 right-0 left-0",!S&&N?"dchan-censor":""].join(" "),style:{maxHeight:"initial"},children:[Object(I.jsxs)("div",{className:"absolute top-0 right-0 z-10",children:[b?Object(I.jsx)("span",{title:"Thread pinned. This might be important.",children:"\ud83d\udccc"}):"",j?Object(I.jsx)("span",{title:"Thread locked. You cannot post.",children:"\ud83d\udd12"}):""]}),!v||N&&!S?"":Object(I.jsx)("div",{children:Object(I.jsx)(Cn,{className:"w-full pointer-events-none shadow-xl object-contain max-h-320px",hash:v,expandable:!1,thumbnail:!1,isSpoiler:k,isNsfw:A&&!(null===(n=a.board)||void 0===n?void 0:n.isNsfw)||!1})}),Object(I.jsxs)("div",{className:"p-1",children:[o&&O?Object(I.jsx)("div",{children:Object(I.jsx)(pe,{board:O,block:null==r?void 0:"".concat(r)})}):"",Object(I.jsxs)("div",{children:[Object(I.jsx)("abbr",{title:"Replies",children:"R"}),": ",Object(I.jsx)("strong",{children:p}),", ",Object(I.jsx)("abbr",{title:"Images",children:"I"}),": ",Object(I.jsx)("strong",{children:m})]}),Object(I.jsxs)("div",{className:"word-wrap",children:[Object(I.jsx)("div",{children:Object(I.jsx)("strong",{className:"text-url",children:u})}),Object(I.jsx)(ec,{style:{minWidth:S?"12rem":"initial",textAlign:"center"},post:h}),S&&x&&Object(mt.a)(x).reverse().map((function(e){return Object(I.jsxs)("div",{className:"mt-1 p-1 border-0 border-t border-black border-solid text-xs text-left",children:[Object(I.jsx)("div",{children:g.DateTime.fromSeconds(parseInt(e.createdAtBlock.timestamp)).toRelative()}),Object(I.jsx)(ec,{post:e})]},e.id)}))]})]})]})})]})})};function nc(e){var t=e.threads,n=e.block,c=e.showBoard,a=void 0!==c&&c;return Object(I.jsx)("div",{className:"flex flex-row flex-wrap justify-center place-items-start font-size-090rem px-2 sm:px-4",children:t.filter((function(e){return!!e&&!!e.board})).map((function(e){return Object(I.jsx)(tc,{thread:e,block:n,showBoard:a},e.id)}))})}function cc(e,t){var n=e.score;return parseInt(n)/1e9<parseInt("".concat(t||1))}function ac(e){var t=e.post,n=A(t.createdAtBlock.timestamp),c=Ye(),a=n.toRelative(),r=c?A(c.timestamp):void 0,s=r&&n.diff(r).milliseconds?n.toRelative({base:r}):"Now",i="".concat(n.toLocaleString({day:"2-digit",month:"2-digit",year:"2-digit"}),"(").concat(n.weekdayShort,")").concat(n.toLocaleString(g.DateTime.TIME_24_WITH_SECONDS));return Object(I.jsxs)("span",{className:"px-0.5 whitespace-nowrap text-sm",title:null!==a?a:void 0,children:[i,Object(I.jsxs)("span",{className:"text-xs px-1 opacity-20 hover:opacity-100 hidden sm:inline-block",children:["[",Object(I.jsx)(l.b,{title:"Time travel to ".concat(i),to:"".concat(K.post(t),"?block=").concat(t.createdAtBlock.number),children:c?Object(I.jsxs)("span",{children:[s," (",a,")"]}):a}),"]"]})]})}function rc(e){var t,n,a=e.post,r=e.thread,s=e.backlinks,o=e.block,d=e.children,b=a.id,j=a.n,u=a.name,h=a.from.address,p=Fe(),O=p.provider,f=p.accounts,v=_e().publish,g=Be(),A=Object(i.a)(g,1)[0],k=ze().isJannyOf,w=f.length>0&&f[0]===h,y=Object(c.useState)(),N=Object(i.a)(y,2),C=N[0],B=N[1],S=!!(null===r||void 0===r||null===(t=r.board)||void 0===t?void 0:t.id)&&k(r.board.id),E=Object(c.useCallback)((function(e,t){v("FORM_QUOTE",{from:e,n:t})}),[v]),T=Object(c.useCallback)(function(){var e=Object(x.a)(m.a.mark((function e(t,n){return m.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,n=n||parseFloat(prompt("How much? (MATIC)")||""),!isNaN(n)){e.next=5;break}return alert("Invalid amount"),e.abrupt("return");case 5:return e.next=7,ie(f[0],t,n);case 7:e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error({onSendTipError:e.t0});case 12:case"end":return e.stop()}}),e,null,[[0,9]])})));return function(t,n){return e.apply(this,arguments)}}(),[f]),D=null===r||void 0===r?void 0:r.isPinned,_=null===r||void 0===r?void 0:r.isLocked,P=b===(null===r||void 0===r?void 0:r.id),H=P&&S,L=w||S,M=S,Q=P&&(w||S),R=s?Object.values(s):[],F=Ie(),z=F.isFavorite,q=F.addFavorite,W=F.removeFavorite,U=!(!r||!z)&&z(r),Y=Object(c.useCallback)((function(){r&&W&&q&&(U?W(r):q(r))}),[q,W,r,U]);return Object(I.jsxs)("span",{className:"max-w-95vw inline-flex flex-wrap items-center relative",children:[P&&r?Object(I.jsx)("button",{className:"inline-block ".concat(U?"opacity-60 hover:opacity-80":"opacity-20 hover:opacity-40"),title:U?"Remove from watched":"Add to watched",onClick:Y,children:"\ud83d\udc41"}):Object(I.jsx)("span",{}),Object(I.jsx)("span",{className:"px-0.5 whitespace-nowrap",children:Object(I.jsx)("span",{className:"text-accent font-bold",children:u&&""!==u?u:"Anonymous"})}),Object(I.jsxs)("span",{className:"px-1 whitespace-nowrap text-sm",children:["(ID: ",Object(I.jsx)(sn,{user:a.from}),O&&f&&f[0]?Object(I.jsx)(tn,{children:Object(I.jsx)("div",{children:Object(I.jsx)("button",{className:"dchan-link flex-grow opacity-50 hover:opacity-100",title:"Send MATIC tip",onClick:function(){return T(h)},children:"\ud83d\udcb8 Send Tip"})})}):"",")"]}),Object(I.jsx)(ac,{post:a}),Object(I.jsxs)("span",{className:"whitespace-nowrap",children:[Object(I.jsxs)("span",{className:"px-0.5 on-parent-target-font-bold text-sm whitespace-nowrap",children:[Object(I.jsx)(l.b,{className:"dchan-link",to:"".concat(K.post(a)).concat(o?"?block=".concat(o):""),title:"Link to this post",children:"No."}),Object(I.jsx)("span",{className:"dchan-link",title:"Reply to this post",onClick:function(){return E(a.from.id,a.n)},children:j})]}),Object(I.jsxs)("span",{children:[P&&D?Object(I.jsx)("span",{title:"Thread pinned. This might be important.",children:"\ud83d\udccc"}):Object(I.jsx)("span",{}),P&&_?Object(I.jsx)("span",{title:"Thread locked. You cannot reply anymore.",children:"\ud83d\udd12"}):Object(I.jsx)("span",{}),cc(a,null===A||void 0===A||null===(n=A.content_filter)||void 0===n?void 0:n.score_threshold)?Object(I.jsx)("span",{title:"Post hidden due to reports. Click to show anyway.",children:"\u26a0\ufe0f"}):Object(I.jsx)("span",{})]}),Object(I.jsxs)(tn,{children:[Object(I.jsx)("div",{children:Object(I.jsx)("a",{href:"https://polygonscan.com/tx/".concat(a.id),title:"TX Details",target:"_blank",rel:"noreferrer",children:"\ud83d\udd0d TX Details"})}),Object(I.jsx)("div",{children:Object(I.jsx)(l.b,{to:"".concat(K.post(a),"?block=").concat(a.createdAtBlock.number),children:"\u23f1\ufe0f Time travel to"})}),f&&f[0]?Object(I.jsxs)("div",{children:[Q?Object(I.jsx)("div",{children:r&&r.isLocked?Object(I.jsxs)("span",{children:[Object(I.jsx)("input",{name:"lock",type:"hidden",value:"false"}),Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return St.apply(this,arguments)}(b,f,B)},children:"\ud83d\udd13 Unlock"})]}):Object(I.jsxs)("span",{children:[Object(I.jsx)("input",{name:"lock",type:"hidden",value:"true"}),Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return It.apply(this,arguments)}(b,f,B)},children:"\ud83d\udd12 Lock"})]})}):"",H?Object(I.jsx)("div",{children:r&&r.isPinned?Object(I.jsxs)("span",{children:[Object(I.jsx)("input",{name:"sticky",type:"hidden",value:"false"}),Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return Tt.apply(this,arguments)}(b,f,B)},children:"\ud83d\udccc Unpin"})]}):Object(I.jsxs)("span",{children:[Object(I.jsx)("input",{name:"sticky",type:"hidden",value:"true"}),Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return Et.apply(this,arguments)}(b,f,B)},children:"\ud83d\udccc Pin"})]})}):"",L?Object(I.jsx)("div",{children:Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return At.apply(this,arguments)}(b,f,B)},children:"\u274c Remove"})}):"",M?Object(I.jsx)("div",{children:Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return Dt.apply(this,arguments)}(b,f,B)},children:"\ud83d\udd2b Ban"})}):"",Object(I.jsx)("div",{children:Object(I.jsx)("button",{onClick:function(){return function(e,t,n){return kt.apply(this,arguments)}(b,f,B)},children:"\u26a0\ufe0f Report"})})]}):""]})]}),d,Object(I.jsx)("span",{className:"dchan-backlinks text-left text-sm flex flex-wrap",children:null===R||void 0===R?void 0:R.map((function(e){return Object(I.jsx)(l.b,{className:"dchan-link px-1",to:"".concat(K.post(e)).concat(o?"?block=".concat(o):""),onMouseEnter:function(){return v("POST_HIGHLIGHT",e.id)},onMouseLeave:function(){return v("POST_DEHIGHLIGHT",e.id)},children:">>".concat(e.n)},e.id)}))}),Object(I.jsx)(en,{status:C})]})}function sc(e){var t,n,a,r,s=e.children,d=e.post,b=e.thread,j=e.header,u=e.block,h=e.enableBacklinks,p=void 0!==h&&h,m=e.showNsfw,x=void 0!==m&&m,O=e.showPostMarker,f=void 0===O||O,v=ze().data,g=Object(c.useState)(!1),A=Object(i.a)(g,2),k=A[0],w=A[1],y=Object(c.useState)(!1),N=Object(i.a)(y,2),C=N[0],B=N[1],S=Object(c.useState)(!1),E=Object(i.a)(S,2),T=E[0],D=E[1],_=Object(c.useState)({}),P=Object(i.a)(_,2),H=P[0],L=P[1],M=Object(c.useRef)(null),Q=_e(),R=Q.subscribe,F=Q.unsubscribe,z=d.id,q=d.from.id,W=d.n,U=d.image,Y=d.bans,V=Object(c.useCallback)((function(){var e;null===(e=M.current)||void 0===e||e.scrollIntoView()}),[M]);Object(c.useEffect)((function(){var e=R("POST_FOCUS",(function(e,t){var n=d.id===t.id;B(n),D(n),n&&V()}));return function(){F(e)}})),Object(c.useEffect)((function(){var e=R("POST_HIGHLIGHT",(function(e,t){d.id===t&&D(!0)}));return function(){F(e)}})),Object(c.useEffect)((function(){var e=R("POST_DEHIGHLIGHT",(function(e,t){d.id!==t||C||D(!1)}));return function(){F(e)}})),Object(c.useEffect)((function(){if(p){var e=R("POST_BACKLINK",(function(e,t){var n=t.from,c=t.to.n;"".concat(c)!=="".concat(d.n)||n.id in H||L(Object(o.a)(Object(o.a)({},H),{},Object(Ae.a)({},n.id,n)))}));return function(){e&&F(e)}}}));var J=U?"https://ipfs.io/ipfs/".concat(U.ipfsHash):"",G=encodeURIComponent(J),X=z===(null===b||void 0===b?void 0:b.id),Z=(null===v||void 0===v||null===(t=v.user)||void 0===t?void 0:t.id)===d.from.id,K=Be(),$=Object(i.a)(K,1)[0],ee=!cc(d,null===$||void 0===$||null===(n=$.content_filter)||void 0===n?void 0:n.score_threshold)||(null===$||void 0===$||null===(a=$.content_filter)||void 0===a?void 0:a.show_below_threshold)||k,te=Object(c.useRef)(null),ne=Object(c.useState)(ee),ce=Object(i.a)(ne,2),ae=ce[0],re=ce[1];return Object(c.useEffect)((function(){te.current&&re(te.current.open)}),[te,re]),Object(I.jsxs)("div",{className:"flex relative",children:[!X&&f?Object(I.jsx)("span",{className:"hidden md:block pl-2 text-secondary",children:">>"}):"",Object(I.jsxs)("div",{className:"mx-auto md:mr-3 md:ml-2 text-left inline overflow-auto ".concat(X?"w-full":""),ref:M,children:[Object(I.jsx)("details",{className:"absolute ml-2 z-10",ref:te,open:ee,onToggle:function(e){re(e.target.open)},children:Object(I.jsx)("summary",{})}),Object(I.jsx)("div",{className:"text-left opacity-50 whitespace-nowrap mb-1 overflow-hidden flex ml-5 ".concat(ae?"hidden":""),title:"Hide/Show",children:Object(I.jsx)(rc,{thread:b,post:d,block:u,children:j})}),Object(I.jsx)("div",{id:"".concat(W),className:"dchan-post text-left w-full  ".concat(ae?"":"hidden"),"dchan-post-from-address":q,children:Object(I.jsxs)("div",{className:"".concat(T||C?"bg-tertiary":X?"":"bg-secondary"," ").concat(Z?"border-dashed border-2 border-tertiary":""," w-full sm:w-full mb-2 inline-block relative"),children:[Object(I.jsxs)("div",{className:"flex sm:flex-wrap ml-5 align-center text-center sm:text-left sm:justify-start max-w-100vw",children:[Object(I.jsx)(rc,{thread:b,post:d,backlinks:H,block:u,children:j}),d.sage?Object(I.jsx)("abbr",{className:"opacity-20 hover:opacity-100",title:"Saged. Thread not bumped.",children:"\ud83c\udf42"}):""]}),ee?Object(I.jsxs)("div",{children:[U?Object(I.jsx)("div",{className:"text-center sm:text-left mx-5",children:Object(I.jsx)("span",{className:"text-sm",children:Object(I.jsxs)("span",{className:"flex flex-wrap",children:[Object(I.jsx)("a",{target:"_blank",rel:"noreferrer",className:"dchan-link underline max-w-64",href:J,title:U.name,children:Object(ke.truncate)(U.name,{length:32,omission:"..."})}),Object(I.jsx)("a",{target:"_blank",rel:"noreferrer",className:"px-1 opacity-20 hover:opacity-100 hidden sm:inline-block",href:J,title:U.name,children:Object(I.jsx)("small",{children:U.ipfsHash})}),Object(I.jsx)(tn,{children:Object(I.jsxs)("div",{children:["Reverse search:",Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{children:Object(I.jsx)("a",{target:"_blank",rel:"noreferrer",className:"dchan-link pr-1",href:"https://www.google.com/searchbyimage?image_url=".concat(G,"amp;safe=off"),children:"google"})}),Object(I.jsx)("div",{children:Object(I.jsx)("a",{target:"_blank",rel:"noreferrer",className:"dchan-link pr-1",href:"https://yandex.com/images/search?rpt=imageview&amp;url=".concat(G),children:"yandex"})}),Object(I.jsx)("div",{children:Object(I.jsx)("a",{target:"_blank",rel:"noreferrer",className:"dchan-link pr-1",href:"//iqdb.org/?url=".concat(G),children:"iqdb"})}),Object(I.jsx)("div",{children:Object(I.jsx)("a",{target:"_blank",rel:"noreferrer",className:"dchan-link pr-1",href:"https://trace.moe/?auto&amp;url=".concat(G),children:"wait"})})]})]})})]})})}):"",Object(I.jsxs)("div",{className:"y-1",children:[Object(I.jsx)("div",{className:"h-full max-w-max flex flex-wrap text-left sm:items-start pb-1 ".concat(X?"max-w-100vw":"max-w-90vw border-bottom-tertiary-accent"),children:Object(I.jsxs)("span",{className:"w-full",children:[U?Object(I.jsx)("div",{className:"overflow-auto float-left mx-5 mb-2",children:Object(I.jsx)(Cn,{hash:U.ipfsHash,isSpoiler:U.isSpoiler,isNsfw:!x&&(U.isNsfw||(null===(r=d.board)||void 0===r?void 0:r.isNsfw))||!1,thumbnail:!0,thumbnailClass:X?"max-w-8rem max-h-32 md:max-w-16rem md:max-h-64":void 0,expandable:!0})}):"",Object(I.jsx)("div",{children:X&&b?Object(I.jsx)("div",{className:"font-semibold md:ml-10 ml-5 ",children:b.subject}):""}),Object(I.jsx)(ec,{className:"md:ml-10 ml-5 mr-5 py-2",post:d,thread:b,block:u}),Y.length>0?Object(I.jsx)("div",{className:"text-xl font-bold text-contrast whitespace-nowrap",children:"( USER WAS BANNED FOR THIS POST )"}):""]})}),s,Object(I.jsx)(l.b,{className:"px-1 text-xs opacity-5 hover:opacity-100 absolute bottom-0 right-0 hidden sm:inline",to:"/".concat(d.id).concat(u?"?block=".concat(u):""),title:"Permalink",children:Object(I.jsx)("small",{children:d.id})})]})]}):Object(I.jsxs)("button",{onClick:function(){return w(!0)},className:"text-2xl text-gray-800",children:[Object(I.jsx)("div",{children:"\u26a0\ufe0f"}),Object(I.jsx)("div",{children:"Post hidden due to reports."}),Object(I.jsx)("div",{className:"text-sm text-gray-600",children:"Click to show anyway."})]})]})})]},z)]})}var ic=Object(c.memo)(sc,ke.isEqual);function oc(e){var t=e.threads,n=e.block,c=e.showBoard,a=void 0!==c&&c;return Object(I.jsx)("div",{children:t.map((function(e){var t,c;return Object(I.jsx)("div",{className:"border-solid border-black py-2 border-b border-secondary",children:Object(I.jsxs)(ic,{post:e.op,thread:e,block:null==n?void 0:"".concat(n),header:Object(I.jsx)("span",{children:Object(I.jsxs)("span",{className:"p-1",children:["[",Object(I.jsx)(l.b,{to:"".concat(K.thread(e)).concat(n?"?block=".concat(n):""),className:"dchan-link",children:"Reply"}),"]",a&&e.board?Object(I.jsx)("span",{children:Object(I.jsx)(pe,{board:e.board,block:null==n?void 0:"".concat(n)})}):""]})}),children:[Object(I.jsx)("div",{className:"text-left pl-8",children:parseInt(e.replyCount)>1+(null===(t=e.replies)||void 0===t?void 0:t.length)?Object(I.jsxs)(l.b,{to:"".concat(K.thread(e)).concat(n?"?block=".concat(n):""),className:"dchan-link",children:["+"," ",parseInt(e.replyCount)-(null===(c=e.replies)||void 0===c?void 0:c.length)," ","replies omitted"]}):""}),Object(mt.a)(e.replies||[]).reverse().map((function(t){return Object(I.jsx)(ic,{post:t,thread:e,block:null==n?void 0:"".concat(n)},t.id)}))]},e.op.id)},e.id)}))})}var lc,dc=n(895);function bc(e){var t,n,a,r,s=e.location,o=e.match.params,b=o.board_id,j=o.board_name;b=b?"0x".concat(b):void 0;var u=Te().lastBlock,h=Object(zt.parse)(s.search),p=parseInt("".concat(h.page||"1")),m=parseInt("".concat(h.block)),x=isNaN(m)?parseInt("".concat((null===u||void 0===u?void 0:u.number)||"0")):m,O=h.date?g.DateTime.fromISO(h.date):void 0,f=Object(d.f)(),A=Be(),k=Object(i.a)(A,1)[0],w=o.view_mode||(null===k||void 0===k||null===(t=k.content_view)||void 0===t?void 0:t.board_default_view_mode)||"catalog",y=(null===k||void 0===k||null===(n=k.content_view)||void 0===n?void 0:n.board_sort_threads_by)||"lastBumpedAt",N=parseInt("".concat((null===k||void 0===k||null===(a=k.content_view)||void 0===a?void 0:a.page_size)||"100")),C={board:b,block:x,orderBy:y,orderDirection:(null===k||void 0===k||null===(r=k.content_view)||void 0===r?void 0:r.board_sort_direction)||"desc",limit:N,skip:N*(p-1)},B=Object(v.a)(Gt,{variables:C}),S=B.refetch,E=B.data,T=B.loading,D=Object(v.a)(Xt,{skip:!x,variables:{board:b,block:x}}),_=D.loading,P=D.data,H=null===P||void 0===P?void 0:P.board,L=null===P||void 0===P?void 0:P.boardRef,M=Object(c.useMemo)((function(){return[].concat(Object(mt.a)((null===E||void 0===E?void 0:E.pinned)||[]),Object(mt.a)((null===E||void 0===E?void 0:E.threads)||[]))}),[E]);Object(c.useEffect)((function(){window.scrollTo({top:0})}),[null===H||void 0===H?void 0:H.id]),Object(c.useEffect)((function(){H&&H.name!==j&&f.replace("/".concat(H.id))}),[H,j,f]),Object(c.useEffect)((function(){var e;!H&&(null===L||void 0===L||null===(e=L.board)||void 0===e?void 0:e.id)&&f.replace("/".concat(L.board.id))}),[H,L,f]),Object(c.useEffect)((function(){S()}),[x,y,S]);var Q=(M||[]).filter((function(e){var t,n;return(null===k||void 0===k||null===(t=k.content_filter)||void 0===t?void 0:t.show_below_threshold)||!Zt(e,null===k||void 0===k||null===(n=k.content_filter)||void 0===n?void 0:n.score_threshold)})),R=Object(c.useMemo)((function(){var e=parseInt("".concat((null===H||void 0===H?void 0:H.threadCount)||0));return Math.max(Math.ceil(H?e/N:0),1)}),[H,N]);return Object(dc.a)(_?"Loading... - dchan.network - [".concat(b,"]"):H?"/".concat(H.name,"/ - dchan.network - [").concat(H.id,"]"):"??? - dchan.network - [".concat(b,"]")),Object(I.jsxs)("div",{className:"bg-primary min-h-100vh flex flex-col","data-theme":(null===H||void 0===H?void 0:H.isNsfw)?"nsfw":"blueboard",children:[Object(I.jsxs)("div",{children:[Object(I.jsx)(kn,{board:H,dateTime:O,baseUrl:H?K.board(H,w):s.pathname+s.hash,block:isNaN(m)?void 0:"".concat(m),summary:T?Object(I.jsx)("span",{children:"..."}):Object(I.jsxs)("span",{children:["Threads: ",M.length," (Hidden:"," ",M.length-Q.length,"), Posts: ",null===H||void 0===H?void 0:H.postCount]}),onRefresh:S}),Object(I.jsxs)("div",{children:[null===H?Object(I.jsxs)("div",{className:"center grid p-8",children:["Board does not exist.",isNaN(m)?"":Object(I.jsxs)(I.Fragment,{children:[Object(I.jsx)("br",{}),"You may have time traveled to before it was created, or after it was deleted."]})]}):T&&!E?Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)(st,{})}):H&&M?0===M.length?Object(I.jsx)("div",{className:"center grid p-8",children:"No threads."}):Object(I.jsx)("div",{children:{catalog:Object(I.jsx)(nc,{threads:Q,block:m}),index:Object(I.jsx)(oc,{threads:Q,block:m})}[w]}):Object(I.jsx)("div",{}),H?Object(I.jsxs)("div",{children:[Object(I.jsx)("hr",{}),Object(I.jsxs)("div",{className:"p-2",children:[Object(I.jsx)("span",{children:p>1?Object(I.jsx)(l.b,{className:"dchan-link px-2",to:"".concat(K.board(H,w),"?page=1").concat(m?"&block=".concat(m):""),children:"<<"}):""}),Object(I.jsx)("span",{children:p>1?Object(I.jsx)(l.b,{className:"dchan-link px-2",to:"".concat(K.board(H,w),"?page=").concat(p-1).concat(m?"&block=".concat(m):""),children:"<"}):""}),Object(I.jsxs)("span",{children:["[",Object(I.jsxs)("button",{className:"dchan-link px-2",onClick:function(){var e=prompt("Page number: (range: 1-".concat(R,")"));if(null!=e){var t=parseInt(e||"");isNaN(t)||t<1||t>R?alert("Invalid page number: ".concat(e)):f.push("".concat(K.board(H,w),"?page=").concat(t).concat(m?"&block=".concat(m):""))}},children:["Page ",p," of ",R]}),"]"]}),Object(I.jsx)("span",{children:p<R?Object(I.jsx)(l.b,{className:"dchan-link px-2",to:"".concat(K.board(H,w),"?page=").concat(p+1).concat(m?"&block=".concat(m):""),children:">"}):""}),Object(I.jsx)("span",{children:p<R?Object(I.jsx)(l.b,{className:"dchan-link px-2",to:"".concat(K.board(H,w),"?page=").concat(R).concat(m?"&block=".concat(m):""),children:">>"}):""})]}),Object(I.jsx)($t,{to:"#board-header",label:"Top"})]}):""]})]}),Object(I.jsx)(J,{showContentDisclaimer:!0})]})}var jc,uc,hc=Object(N.a)(lc||(lc=Object(y.a)(["\n  ","\n\n  query PostsGetLast($board: String!) {\n    posts(orderBy: createdAt, orderDirection: desc, first: 50, where: {sage: false, board_starts_with: $board, board_ends_with: $board}) {\n      ...Post\n    }\n  }\n"])),tt),pc=Object(N.a)(jc||(jc=Object(y.a)(["\n  ","\n\n  query PostsGetLast($block: Int!, $board: String!) {\n    posts(orderBy: createdAt, orderDirection: desc, first: 50, where: {sage: false, board_starts_with: $board, board_ends_with: $board}, block: {number: $block}) {\n      ...Post\n    }\n  }\n"])),tt);function mc(e){var t,n=e.post,c=e.block;return Object(I.jsx)("div",{className:"my-2","data-theme":(null===n||void 0===n||null===(t=n.board)||void 0===t?void 0:t.isNsfw)?"nsfw":"blueboard",children:Object(I.jsx)(ic,{post:n,block:c,showPostMarker:!1,header:Object(I.jsxs)("span",{children:[n.board?Object(I.jsxs)("span",{className:"p-1 whitespace-nowrap",children:["[",Object(I.jsx)(pe,{board:n.board,block:c}),"]"]}):"",Object(I.jsxs)("span",{className:"p-1 whitespace-nowrap",children:["[",Object(I.jsx)(l.b,{to:"/".concat(n.id).concat(c?"?block=".concat(c):""),className:"dchan-link inline",children:"View"}),"]"]})]})},n.id)})}function xc(e){var t,n=e.block,c=e.board,a=n?pc:hc,r=Object(v.a)(a,{pollInterval:5e3,variables:{block:n,board:(null===c||void 0===c?void 0:c.id)||""}}),s=r.loading,i=r.data;return Object(I.jsx)("div",{children:s&&!i?Object(I.jsx)(st,{}):null===i||void 0===i||null===(t=i.posts)||void 0===t?void 0:t.map((function(e){return Object(I.jsx)(mc,{post:e,block:n?"".concat(n):void 0},e.id)}))})}var Oc,fc,vc=Object(N.a)(uc||(uc=Object(y.a)(["\n  ","\n\n  query ThreadsListMostPopular($cutoff: Int!, $board: String!) {\n    threads(orderBy: replyCount, orderDirection: desc, first: 10, where: {lastBumpedAt_gt: $cutoff, board_starts_with: $board, board_ends_with: $board}) {\n      ...Thread\n    }\n  }\n"])),nt),gc=Object(N.a)(Oc||(Oc=Object(y.a)(["\n  ","\n\n  query ThreadsListMostPopular($cutoff: Int!, $board: String!, $block: Int!) {\n    threads(orderBy: replyCount, orderDirection: desc, first: 10, where: {lastBumpedAt_gt: $cutoff, board_starts_with: $board, board_ends_with: $board}, block: {number: $block}) {\n      ...Thread\n    }\n  }\n"])),nt);function Ac(e){var t=e.block,n=e.board,a=Ye(),r=Object(c.useMemo)((function(){return Math.floor((a?parseInt(a.timestamp):g.DateTime.now().toSeconds())-604800)}),[a]),s=t?gc:vc,i=Object(v.a)(s,{pollInterval:3e4,fetchPolicy:t?"cache-first":"network-only",variables:{cutoff:r,block:a?parseInt(a.number):t,board:(null===n||void 0===n?void 0:n.id)||""}}),o=i.loading,l=i.data;return o?Object(I.jsx)(st,{}):(null===l||void 0===l?void 0:l.threads.length)?Object(I.jsx)(oc,{threads:l.threads,showBoard:!0,block:t}):Object(I.jsx)("span",{children:"No threads active."})}var kc,wc=Object(N.a)(fc||(fc=Object(y.a)(["\n  ","\n\n  query Threads($ids: [String!]!, $block: Int!) {\n    threads(orderBy: lastBumpedAt, orderDirection: desc, where: {id_in: $ids}, block: {number: $block}) {\n      ...Thread\n      replies(first: 3, orderBy: n, orderDirection: desc) {\n        ...Post\n      }\n    }\n  }\n"])),nt);function yc(e){var t=e.block,n=Ie().favorites,a=Object(c.useMemo)((function(){return n?Object.keys(n):[]}),[n]),r=Object(v.a)(t?wc:ct,{pollInterval:3e4,fetchPolicy:t?"cache-first":"network-only",variables:{ids:a,block:t},skip:!n}),s=r.data,i=r.loading,o=null===s||void 0===s?void 0:s.threads;return i||o&&o.length>0?i?Object(I.jsx)(st,{}):Object(I.jsx)(nc,{threads:o||[],showBoard:!0,block:t}):Object(I.jsx)("span",{children:"No threads are being watched. Use the \ud83d\udc41 button on threads to keep track of them here."})}var Nc,Cc=Object(N.a)(kc||(kc=Object(y.a)(["\n  fragment Board on Board {\n    id\n    title\n    postCount\n    name\n    isLocked\n    isNsfw\n  }\n\n  query Boards($block: Int!) {\n    boards(orderBy: postCount, orderDirection: desc, first: 10, block: {number: $block}) {\n      ...Board\n    }\n  }\n"])));function Bc(e){var t=e.block,n=t?Cc:Oe,a=Object(v.a)(n,{pollInterval:3e4,fetchPolicy:t?"cache-first":"network-only",variables:{block:t}}),r=a.loading,s=a.data,i=Object(c.useCallback)((function(){Object(De.publish)("BOARD_ALL_HOVER_ENTER")}),[]);return Object(I.jsxs)("div",{children:[Object(I.jsx)(xt,{className:"grid",loading:r,boards:null===s||void 0===s?void 0:s.boards,block:t}),Object(I.jsxs)("div",{onMouseEnter:i,children:["[",Object(I.jsx)(l.b,{className:"dchan-link py-1 px-4",to:"/_/boards",children:"All boards"}),"]"]})]})}function Ic(e){var t=e.location;Object(dc.a)("dchan.network");var n=Object(c.useState)(),a=Object(i.a)(n,2),r=a[0],s=a[1],o=Object(zt.parse)(t.search),l=parseInt("".concat(o.block)),d=isNaN(l)?void 0:l,b=o.date?g.DateTime.fromISO(o.date):void 0;return Object(c.useEffect)((function(){window.scrollTo({top:0})}),[]),Object(c.useEffect)((function(){var e=Object(De.subscribe)("BOARD_ITEM_HOVER_ENTER",(function(e,t){s(t)}));return function(){return Object(De.unsubscribe)(e)}}),[s]),Object(c.useEffect)((function(){var e=Object(De.subscribe)("BOARD_ALL_HOVER_ENTER",(function(){s(void 0)}));return function(){return Object(De.unsubscribe)(e)}}),[s]),Object(I.jsxs)("div",{className:"h-screen bg-primary flex flex-col pb-8",children:[Object(I.jsx)(dt,{baseUrl:"/",block:d?"".concat(d):void 0,dateTime:b}),Object(I.jsx)(bt,{}),Object(I.jsxs)("div",{className:"flex flex-col grid-cols-3 xl:grid px-4",children:[Object(I.jsxs)("div",{className:"w-full px-2 pb-2",children:[Object(I.jsx)(E,{title:Object(I.jsx)("span",{children:"Popular Boards"}),className:"md:px-1 w-full pb-4",children:Object(I.jsx)(Bc,{block:d})}),Object(I.jsx)(E,{title:Object(I.jsx)("span",{children:"Watched Threads"}),className:"md:px-1 w-full pb-4",children:Object(I.jsx)(yc,{block:d})})]}),Object(I.jsx)(E,{title:Object(I.jsxs)("span",{children:["Latest Posts ",r?Object(I.jsxs)("span",{children:["on ",Object(I.jsx)(pe,{board:r,block:null==l?void 0:"".concat(l)})]}):""]}),className:"w-full px-2 pb-2",children:Object(I.jsx)(xc,{block:d,board:r})}),Object(I.jsx)(E,{title:Object(I.jsxs)("span",{children:["Popular Threads ",r?Object(I.jsxs)("span",{children:["on ",Object(I.jsx)(pe,{board:r,block:null==l?void 0:"".concat(l)})]}):""]}),className:"md:px-1 w-full pb-4",children:Object(I.jsx)(Ac,{block:d,board:r})})]}),Object(I.jsx)(J,{})]})}var Sc,Ec=Object(N.a)(Nc||(Nc=Object(y.a)(["\n  query ChanStatus($id: String!) {\n    chanStatus(id: $id) {\n      isLocked\n    }\n  }\n"]))),Tc=n.p+"static/media/poopie.57245890.png";function Dc(){var e,t,n,c=Be(),a=Object(i.a)(c,1)[0],r=Object(v.a)(Ec,{variables:{id:(null===a||void 0===a||null===(e=a.contract)||void 0===e?void 0:e.address)||""},skip:!(null===a||void 0===a||null===(t=a.contract)||void 0===t?void 0:t.address)}).data;return(null===r||void 0===r||null===(n=r.chanStatus)||void 0===n?void 0:n.isLocked)?Object(I.jsx)("div",{className:"bg-primary relative",style:{height:"100000vh"},children:Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)(E,{title:Object(I.jsx)("div",{className:"text-red-500 text-4xl",children:"UH OH"}),className:"pt-4",children:Object(I.jsxs)("div",{className:"center grid",children:[Object(I.jsx)("img",{src:Tc,alt:"poopie"}),Object(I.jsxs)("div",{className:"p-4",children:[Object(I.jsx)("div",{className:"text-md",children:"Someone made a stinky and dchan got locked."}),Object(I.jsx)("div",{className:"text-sm",children:"Hopefully it wasn't you."})]})]})})})}):Object(I.jsx)("span",{})}var _c,Pc,Hc=Object(N.a)(Sc||(Sc=Object(y.a)(["\n  ","\n  \n  query PostSearch($search: String!) {\n    postSearch(text: $search, orderBy: createdAt, orderDirection: desc) {\n      ...Post\n    }\n  }\n"])),tt),Lc=Object(N.a)(_c||(_c=Object(y.a)(["\n  ","\n  \n  query PostSearch($search: String!, $block: Int!) {\n    postSearch(text: $search, orderBy: createdAt, orderDirection: desc, block: {number: $block}) {\n      ...Post\n    }\n  }\n"])),tt);function Mc(e){var t=e.location,n=(e.match.params,Object(zt.parse)(t.search)),a=n.s||n.search,r=Object(ke.isString)(a)?a:"",s=parseInt("".concat(n.block)),o=isNaN(s)?void 0:"".concat(s),d=n.date?g.DateTime.fromISO(n.date):void 0,b=Be(),j=Object(i.a)(b,1)[0],u={block:s,search:r.length>1?"".concat(r,":*"):""},h=Object(v.a)(s?Lc:Hc,{variables:u,pollInterval:6e4}),p=h.refetch,m=h.data,x=h.loading,O=null===m||void 0===m?void 0:m.postSearch,f=Object(c.useMemo)((function(){return(e=O?O.filter((function(e){return e&&e.thread&&e.board})):[])&&e.length>0?Object(ke.reverse)(Object(ke.sortBy)(e,["createdAtBlock"])):void 0;var e}),[O]);return Object(c.useEffect)((function(){window.scrollTo({top:0})}),[r]),Object(c.useEffect)((function(){p()}),[r,s,p]),Object(I.jsxs)("div",{className:"bg-primary min-h-100vh flex flex-col","data-theme":"blueboard",children:[Object(I.jsx)(kn,{dateTime:d,search:r,baseUrl:"".concat(K.posts()).concat(r?"?s=".concat(r):""),block:o,summary:f?Object(I.jsxs)("span",{children:["Found: ",f.length," posts (Hidden:"," ",f.filter((function(e){var t;return cc(e,null===j||void 0===j||null===(t=j.content_filter)||void 0===t?void 0:t.score_threshold)})).length,")"]}):Object(I.jsx)("span",{children:"..."}),onRefresh:p}),Object(I.jsx)("div",{children:x?Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)(st,{})}):f&&f.length?Object(I.jsx)("div",{children:Object(I.jsx)("div",{children:null===f||void 0===f?void 0:f.map((function(e){var t,n,c,a;return Object(I.jsx)("div",{className:"p-2 flex flex-wrap",children:Object(I.jsx)(ic,{post:e,block:o,header:Object(I.jsxs)("span",{children:[Object(I.jsxs)("span",{className:"p-1",children:["[",Object(I.jsx)("span",{className:"p-1",children:Object(I.jsxs)(l.b,{className:"dchan-link",to:"/".concat(null===(t=e.board)||void 0===t?void 0:t.name,"/").concat(null===(n=e.board)||void 0===n?void 0:n.id),children:["/",null===(c=e.board)||void 0===c?void 0:c.name,"/",Object(I.jsx)(je,{id:(null===(a=e.board)||void 0===a?void 0:a.id)||"0x000000"})]})}),"]"]}),Object(I.jsxs)("span",{className:"p-1",children:["[",Object(I.jsx)(l.b,{to:"/".concat(e.id),className:"dchan-link",children:"View"}),"]"]})]})},e.id)})}))})}):"No results"}),Object(I.jsx)(J,{showContentDisclaimer:!0})]})}function Qc(){var e=Object(d.f)(),t=Object(c.useCallback)((function(){e.goBack()}),[e]);return Object(I.jsx)("button",{className:"text-blue-600 visited:text-purple-600 m-4",onClick:t,children:"Go back"})}function Rc(e){var t=e.subject,n=e.children;return Object(I.jsx)("div",{className:"font-family-arial text-center",children:Object(I.jsx)("div",{className:"grid center min-h-100vh",children:Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"text-4xl text-contrast font-weight-800 font-family-tahoma m-4",children:t}),Object(I.jsx)("div",{className:"grid center m-4",children:n}),Object(I.jsx)("div",{children:Object(I.jsx)(Qc,{})}),Object(I.jsx)("div",{children:Object(I.jsx)(l.b,{className:"text-blue-600 visited:text-purple-600 m-4",to:"/",children:"Go home"})})]})})})}var Fc,zc=Object(N.a)(Pc||(Pc=Object(y.a)(["\n  ","\n\n  fragment Board on Board {\n    id\n    name\n  }\n\n  fragment Thread on Thread {\n    id\n    n\n    board {\n      ...Board\n    }\n    op {\n      from {\n        ...User\n      }\n    }\n  }\n\n  fragment Post on Post {\n    id\n    n\n    from {\n      id\n    }\n    board {\n      ...Board\n    }\n    thread {\n      ...Thread\n    }\n  }\n\n  fragment PostRef on PostRef {\n    id\n    post {\n      ...Post\n    }\n  }\n\n  query SearchByRef($id: String!, $post_n: BigInt!, $post_ref: String!) {\n    threads(where: {board: $id, n: $post_n}) {\n      ...Thread\n    }\n    posts(where: {from: $id, n: $post_n}) {\n      ...Post\n    }\n    postRef(id: $post_ref) {\n      ...PostRef\n    }\n  }\n"])),Pe);function qc(e){var t=e.match.params,n=Object(c.useState)(),a=Object(i.a)(n,2),r=a[0],s=a[1],o=Object(d.f)(),l="0x".concat(t.id),b=t.post_n,j="".concat(l,"/").concat(b),u=Object(v.a)(zc,{variables:{id:l,post_n:b,post_ref:j}}),h=u.loading,p=u.data;return Object(c.useEffect)((function(){if(p){var e=null,t=null,n=null,c=p.threads,a=p.posts,r=p.postRef;c&&c.length>0?t=c[0]:a&&a.length>0?n=a[0]:r&&(n=r.post),t?e="".concat(K.thread(t)):n&&(e="".concat(K.post(n))),(t||n||r)&&!e&&s("Content not found. It may have been deleted, or the ID is invalid."),e&&o.replace(e)}}),[o,p]),Object(I.jsx)("div",{className:"bg-primary center grid w-screen h-screen",children:r?Object(I.jsx)(Rc,{subject:"Not found",children:Object(I.jsx)("span",{children:r})}):Object(I.jsxs)("div",{children:[h?Object(I.jsx)(st,{}):"",Object(I.jsxs)("div",{className:"text-xs",children:[l,"/",b]})]})})}var Wc,Uc,Yc=Object(N.a)(Fc||(Fc=Object(y.a)(["\n  ","\n  ","\n  ","\n  \n  query Thread($board: String!, $n: String!, $block: Int!) {\n    board(id: $board) {\n      ...Board\n    }\n    posts(first: 1, where: {board: $board, n: $n}, block: {number: $block}) {\n      ...Post\n    }\n    threads(first: 1, where: {board: $board, n: $n}, block: {number: $block}) {\n      ...Thread\n      replies(orderBy: n) {\n        ...Post\n      }\n    }\n  }\n"])),qt,nt,tt),Vc=Object(N.a)(Wc||(Wc=Object(y.a)(["\n  ","\n  ","\n  ","\n  \n  query Thread($board: String!, $n: String!) {\n    board(id: $board) {\n      ...Board\n    }\n    posts(first: 1, where: {board: $board, n: $n}) {\n      ...Post\n    }\n    threads(first: 1, where: {board: $board, n: $n}) {\n      ...Thread\n      replies(orderBy: n) {\n        ...Post\n      }\n    }\n  }\n"])),qt,nt,tt);function Jc(e){var t,n,a=e.location,r=e.match.params,s=r.board_name,i=r.board_id,o=r.user_id,l=r.thread_n;i=i?"0x".concat(i):void 0;var b=Object(d.f)(),j=_e().publish,u=Object(zt.parse)(a.search),h=parseInt("".concat(u.block)),p=u.date?g.DateTime.fromISO(u.date):void 0,m=r.focus_user_id?"0x".concat(r.focus_user_id):"",x=r.focus_post_n||"",O={board:i,n:l,block:h},f=Object(v.a)(h?Yc:Vc,{variables:O}),A=f.refetch,k=f.data,w=f.loading,y=null===k||void 0===k||null===(t=k.posts)||void 0===t?void 0:t[0],N=null===k||void 0===k||null===(n=k.threads)||void 0===n?void 0:n[0],C=null===k||void 0===k?void 0:k.board,B=Object(c.useMemo)((function(){return N?[N.op].concat(Object(mt.a)(N.replies)):[]}),[N]);return Object(c.useEffect)((function(){window.scrollTo({top:0})}),[null===N||void 0===N?void 0:N.id]),Object(c.useEffect)((function(){var e=!N&&y?K.post(y):void 0;e&&b.replace("".concat(e).concat(h?"?block=".concat(h):""))}),[b,N,h,y]),Object(c.useEffect)((function(){var e=w||!m&&!x?[]:B.filter((function(e){var t=!m||e.from.id===m||"0x".concat(ce(e.from.id).replace("-",""))===m,n=!x||e.n===x;return t&&n}));if(1===e.length){var t=e[0];b.replace("".concat(K.post(t)).concat(h?"?block=".concat(h):"")),j("POST_FOCUS",t)}else{if(e.length>1)throw new Error("Somehow multiple posts were focused?");!w&&m&&x&&b.replace("/".concat(m,"/").concat(x))}}),[B,m,x,h,w,j,b]),Object(c.useEffect)((function(){if(C&&N&&(s!==C.name||o!==N.op.from.id)){var e=K.thread(N);e&&b.replace("".concat(e).concat(h?"?block=".concat(h):""))}}),[C,N,s,o,b,h]),Object(c.useEffect)((function(){A({block:h})}),[h,A]),Object(dc.a)(C&&N?"/".concat(C.name,"/ - ").concat(N.subject||N.op.comment," - dchan.network - [").concat(N.id,"]"):"/".concat(i,"/ - Loading... - dchan.network")),Object(I.jsxs)("div",{className:"bg-primary min-h-100vh flex flex-col","data-theme":(null===C||void 0===C?void 0:C.isNsfw)?"nsfw":"blueboard",children:[Object(I.jsx)(kn,{board:C,thread:N,dateTime:p,baseUrl:N?K.thread(N):a.pathname+a.hash,block:isNaN(h)?void 0:"".concat(h),summary:w?Object(I.jsx)("span",{children:"..."}):Object(I.jsxs)("span",{children:["Posts: ",B.length]}),onRefresh:A}),Object(I.jsx)("div",{children:w&&!k?Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)(st,{})}):B&&N?Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{children:B.map((function(e){var t;return Object(I.jsx)(ic,{block:isNaN(h)?void 0:"".concat(h),post:e,thread:N,enableBacklinks:!0,showNsfw:null===(t=N.board)||void 0===t?void 0:t.isNsfw},e.id)}))}),Object(I.jsx)($t,{to:"#board-header",label:"Top"})]}):"Post not found."}),Object(I.jsx)(J,{showContentDisclaimer:!!B&&!!N})]})}function Gc(){var e=Be(),t=Object(i.a)(e,2),n=t[0],a=t[1],r=Object(c.useState)(!1),s=Object(i.a)(r,2),l=s[0],d=s[1],b=Object(c.useCallback)((function(e){d(e.target.checked)}),[d]),j=Object(c.useCallback)((function(){a(Object(o.a)(Object(o.a)({},n),{},{eula:Object(o.a)(Object(o.a)({},null===n||void 0===n?void 0:n.eula),{},{agreed:l})}))}),[l,n,a]);return Object(I.jsx)("div",{className:"center-grid w-full min-h-screen bg-primary",children:Object(I.jsx)("div",{className:"flex flex-wrap center",children:Object(I.jsx)(E,{title:Object(I.jsxs)("span",{children:[Object(I.jsx)("a",{className:"color-black",href:"/",children:"dchan.network"})," ","EULA"]}),children:Object(I.jsxs)("div",{children:[Object(I.jsx)("div",{className:"center grid",children:Object(I.jsx)("img",{className:"p-2 w-16 pointer-events-none",src:at,alt:"dchan"})}),Object(I.jsxs)("div",{className:"p-1 text-left",children:[Object(I.jsx)("div",{className:"p-2",children:"To use dchan.network, you understand and agree to the following:"}),Object(I.jsx)("div",{className:"p-2",children:"* The content of this website is for mature audiences only and may not be suitable for minors. If you are a minor or it is illegal for you to access mature images and language, do not proceed."}),Object(I.jsx)("div",{className:"p-2",children:"* Content is presented to you AS IS, with no warranty, express or implied."}),Object(I.jsx)("div",{className:"p-2",children:'By clicking "I Agree," you agree to accept full responsibility for any damages from your use of the website, and you understand that the content posted is not owned or generated by dchan.network, but rather by dchan.network\'s users.'}),Object(I.jsxs)("div",{className:"text-center",children:[Object(I.jsxs)("div",{className:"p-2",children:[Object(I.jsx)("input",{id:"dchan-input-agree",className:"mx-1 text-xs whitespace-nowrap opacity-50 hover:opacity-100",type:"checkbox",checked:l,onChange:b}),Object(I.jsx)("label",{htmlFor:"dchan-input-agree",children:"I agree"})]}),Object(I.jsxs)("div",{className:"p-2",children:["[",Object(I.jsx)("button",{className:"dchan-link",disabled:!l,onClick:j,children:"Proceed"}),"]"]})]})]})]})})})})}var Xc,Zc=Object(N.a)(Uc||(Uc=Object(y.a)(["\n  ","\n  ","\n  ","\n\n  query SearchById($id: String!) {\n    boardRef(id: $id) {\n      board {\n        ...Board\n      }\n    }\n    threadRef(id: $id) {\n      thread {\n        ...Thread\n      }\n    }\n    postRef(id: $id) {\n      post {\n        ...Post\n      }\n    }\n    board(id: $id) {\n      ...Board\n    }\n    thread(id: $id) {\n      ...Thread\n    }\n    post(id: $id) {\n      ...Post\n    }\n    user(id: $id) {\n      id\n    }\n  }\n"])),qt,nt,tt),Kc=Object(N.a)(Xc||(Xc=Object(y.a)(["\n  ","\n  ","\n  ","\n\n  query SearchById($id: String!, $block: Int!) {\n    boardRef(id: $id, block: {number: $block}) {\n      board {\n        ...Board\n      }\n    }\n    threadRef(id: $id, block: {number: $block}) {\n      thread {\n        ...Thread\n      }\n    }\n    postRef(id: $id, block: {number: $block}) {\n      post {\n        ...Post\n      }\n    }\n    board(id: $id, block: {number: $block}) {\n      ...Board\n    }\n    thread(id: $id, block: {number: $block}) {\n      ...Thread\n    }\n    post(id: $id, block: {number: $block}) {\n      ...Post\n    }\n    user(id: $id, block: {number: $block}) {\n      id\n    }\n  }\n"])),qt,nt,tt);function $c(e){var t,n=e.location,a=e.match.params,r=Object(c.useState)(),s=Object(i.a)(r,2),o=s[0],l=s[1],b=Object(d.f)(),j="0x".concat(a.id),u=Object(zt.parse)(n.search),h="".concat(u.block);h&&(t=parseInt(h),isNaN(t)&&(t=void 0));var p=t?Kc:Zc,m=Object(v.a)(p,{variables:{id:j,block:t||void 0},pollInterval:5e3}).data;return Object(c.useEffect)((function(){if(m){var e=null,n=m.boardRef,c=m.threadRef,a=m.postRef,r=m.board,s=m.thread,i=m.post;!r&&n?r=n.board:!s&&c?s=c.thread:!i&&a&&(i=a.post);var o=t?"?block=".concat(t):"";r?e="".concat(K.board(r)).concat(o):s?e="".concat(K.thread(s)).concat(o):i&&(e="".concat(K.post(i)).concat(o)),(r||s||i)&&!e&&l("Content not found. It may have been deleted, or the ID is invalid."),e&&b.replace(e)}}),[b,m,t]),Object(I.jsx)("div",{className:"bg-primary center grid w-screen h-screen",children:o?Object(I.jsx)(Rc,{subject:"Not found",children:Object(I.jsx)("span",{children:o})}):Object(I.jsxs)("div",{children:[Object(I.jsx)(st,{}),Object(I.jsx)("div",{className:"text-xs",children:j}),Object(I.jsx)("div",{children:Object(I.jsx)(ut,{children:Object(I.jsx)("span",{children:-1!==j.indexOf("-")?"The content is being indexed, please wait...":"Are you sure it's a valid ID?"})})})]})})}var ea=!1;function ta(){var e=Be(),t=Object(i.a)(e,2),n=t[0],a=t[1];return Object(c.useEffect)((function(){if(!ea&&n){ea=!0;var e=Object(o.a)({},n);e.subgraph.endpoint=ne.subgraph.endpoint,e.ipfs.endpoint=ne.ipfs.endpoint,a(e)}}),[a,n]),null}var na=function(){var e,t=Object(c.useState)((function(){try{var e=window.localStorage.getItem("dchan.config");return e?Object(o.a)(Object(o.a)({},ne),JSON.parse(e)):ne}catch(t){return console.error({error:t}),ne}})),n=Object(i.a)(t,2),a=n[0],r=n[1];ge=r;var s=Object(c.useMemo)((function(){return new b.a({uri:ne.subgraph.endpoint,cache:new j.a})}),[]);return!1===(null===a||void 0===a||null===(e=a.eula)||void 0===e?void 0:e.agreed)?Object(I.jsx)(Gc,{}):Object(I.jsxs)(u.a,{client:s,children:[Object(I.jsx)(h.a,{}),Object(I.jsx)(ta,{}),Object(I.jsxs)(l.a,{basename:"/",children:[Object(I.jsx)(Dc,{}),Object(I.jsxs)("div",{className:"App text-center",children:[Object(I.jsxs)(d.c,{children:[Object(I.jsx)(d.a,{exact:!0,path:"/",component:Ic}),Object(I.jsx)(d.a,{exact:!0,path:"/_/boards",component:Vt}),Object(I.jsx)(d.a,{path:"/_/admin",component:pt}),Object(I.jsx)(d.a,{path:"/_/posts",component:Mc}),Object(I.jsx)(d.a,{path:"/0x:id/:post_n",component:qc}),Object(I.jsx)(d.a,{path:"/0x:id",component:$c}),Object(I.jsx)(d.a,{path:"/:board_name/0x:board_id/:view_mode(index|catalog)",component:bc}),Object(I.jsx)(d.a,{path:"/:board_name/0x:board_id/0x:user_id/:thread_n/0x:focus_user_id/:focus_post_n",component:Jc}),Object(I.jsx)(d.a,{path:"/:board_name/0x:board_id/0x:user_id/:thread_n/0x:focus_user_id",component:Jc}),Object(I.jsx)(d.a,{path:"/:board_name/0x:board_id/0x:user_id/:thread_n/:focus_post_n",component:Jc}),Object(I.jsx)(d.a,{path:"/:board_name/0x:board_id/0x:user_id/:thread_n/:post_n",component:Jc}),Object(I.jsx)(d.a,{path:"/:board_name/0x:board_id/0x:user_id/:thread_n",component:Jc}),Object(I.jsx)(d.a,{path:"/:board_name/0x:board_id",component:bc}),Object(I.jsx)(d.a,{exact:!0,path:"/:board_name",component:Vt})]}),Object(I.jsx)(M,{}),Object(I.jsx)(z,{}),Object(I.jsx)(Y,{})]})]})]})},ca=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,906)).then((function(t){var n=t.getCLS,c=t.getFID,a=t.getFCP,r=t.getLCP,s=t.getTTFB;n(e),c(e),a(e),r(e),s(e)}))};s.a.render(Object(I.jsx)(a.a.StrictMode,{children:Object(I.jsx)(na,{})}),document.getElementById("root")),ca()}},[[881,1,2]]]);